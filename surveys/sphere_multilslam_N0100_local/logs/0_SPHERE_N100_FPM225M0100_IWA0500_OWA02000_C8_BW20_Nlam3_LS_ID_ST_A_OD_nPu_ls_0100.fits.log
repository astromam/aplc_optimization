/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslam_N0100_local/drivers/0_SPHERE_N100_FPM225M0100_IWA0500_OWA02000_C8_BW20_Nlam3_LS_ID_ST_A_OD_nPu_ls_0100.fits.py:108: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslam_N0100_local/drivers/0_SPHERE_N100_FPM225M0100_IWA0500_OWA02000_C8_BW20_Nlam3_LS_ID_ST_A_OD_nPu_ls_0100.fits.py:116: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 100,
                      'radius': 2.252},
 'image': {'bandwidth': 0.2,
           'contrast': 8,
           'iwa': 5,
           'num_wavelengths': 3,
           'owa': 20,
           'resolution': 2},
 'instrument': {'inst_name': 'SPHERE'},
 'lyot_stop': {'alignment_tolerance': 1,
               'filename': 'SPHERE/sphere_stop_ST_ALC2_nPup0100.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 100,
           'filename': 'SPHERE/pupil=vlt_btw_nPup=100.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslam_N0100_local/analysis',
 'drivers_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslam_N0100_local/drivers',
 'input_files_dir': '/Users/mndiaye/python/aplc_optimization/masks',
 'log_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslam_N0100_local/logs',
 'solution_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslam_N0100_local/solutions',
 'survey_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslam_N0100_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: no
   Searching for mirror symmetric Lyot stops in x...
      Found Lyot stop #2 to fit.
Lyot stop #1:
   Mirror symmetry in x: no
   Searching for mirror symmetric Lyot stops in x...
      Found Lyot stop #3 to fit.
Lyot stop #2:
   Will be ignored due to symmetries with Lyot stops #[0]
Lyot stop #3:
   Will be ignored due to symmetries with Lyot stops #[1]
Lyot stop #0:
   Mirror symmetry in y: no
   Searching for mirror symmetric Lyot stops in y...
      Found Lyot stop #1 to fit.
Lyot stop #1:
   Will be ignored due to symmetries with Lyot stops #[0]
Lyot stop #2:
   Will be ignored due to symmetries with Lyot stops #[0]
Lyot stop #3:
   Will be ignored due to symmetries with Lyot stops #[1]

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 1913 variables and 14124 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2023-12-14
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Wavelength 1/3; Variable 1000/1913
Wavelength 2/3; Variable 1000/1913
Wavelength 3/3; Variable 1000/1913
Start optimization...
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 28248 rows, 1913 columns and 54038424 nonzeros
Model fingerprint: 0xbad7ef73
Coefficient statistics:
  Matrix range     [1e-12, 7e-04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-04, 1e-04]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve time: 12.07s
Presolved: 1913 rows, 30161 columns, 54040337 nonzeros
Ordering time: 0.01s

Barrier statistics:
 AA' NZ     : 1.829e+06
 Factor NZ  : 1.831e+06 (roughly 30 MB of memory)
 Factor Ops : 2.335e+09 (less than 1 second per iteration)
 Threads    : 8

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   8.58844197e+03  0.00000000e+00  0.00e+00 0.00e+00  7.15e-01    16s
   1   5.11610623e+03  3.93239620e+02  0.00e+00 2.60e-02  1.77e-01    18s
   2   2.54721622e+03  4.70648837e+02  0.00e+00 1.95e-02  7.46e-02    19s
   3   1.37956254e+03  5.27287135e+02  0.00e+00 1.01e-02  2.91e-02    21s
   4   9.20918080e+02  5.53368349e+02  0.00e+00 5.86e-03  1.23e-02    22s
   5   7.42623384e+02  5.68565602e+02  0.00e+00 3.36e-03  5.76e-03    24s
   6   6.51173884e+02  5.81795459e+02  0.00e+00 1.45e-03  2.28e-03    26s
   7   6.13644090e+02  5.87066015e+02  0.00e+00 8.60e-04  8.89e-04    29s
   8   6.00112769e+02  5.91103329e+02  0.00e+00 3.53e-04  3.05e-04    31s
   9   5.97460622e+02  5.92831039e+02  0.00e+00 1.77e-04  1.56e-04    33s
  10   5.95439993e+02  5.93732408e+02  0.00e+00 6.92e-05  5.78e-05    34s
  11   5.94744193e+02  5.94051023e+02  0.00e+00 2.61e-05  2.33e-05    36s
  12   5.94435545e+02  5.94163700e+02  0.00e+00 1.23e-05  9.29e-06    38s
  13   5.94335769e+02  5.94208677e+02  0.00e+00 6.95e-06  4.42e-06    39s
  14   5.94299246e+02  5.94242478e+02  0.00e+00 2.92e-06  1.96e-06    40s
  15   5.94282514e+02  5.94254816e+02  8.00e-07 1.44e-06  9.60e-07    42s
  16   5.94271871e+02  5.94263052e+02  4.61e-06 4.58e-07  3.05e-07    43s
  17   5.94268031e+02  5.94266458e+02  4.97e-06 5.84e-08  5.23e-08    45s
  18   5.94267008e+02  5.94266936e+02  1.55e-05 5.69e-09  4.43e-09    47s
  19   5.94266980e+02  5.94266974e+02  6.65e-06 2.01e-09  1.31e-09    53s
  20   5.94266951e+02  5.94266985e+02  5.53e-06 9.40e-10  5.55e-10    58s
  21   5.94266913e+02  5.94266989e+02  6.96e-06 5.55e-10  3.82e-10    60s
  22   5.94266887e+02  5.94266993e+02  6.98e-06 1.86e-10  1.52e-10    63s
  23   5.94266873e+02  5.94266993e+02  1.05e-05 1.75e-10  1.27e-10    65s
  24   5.94266849e+02  5.94266993e+02  1.07e-05 1.08e-10  8.69e-11    66s
  25   5.94266897e+02  5.94266994e+02  6.11e-06 6.19e-12  2.66e-11    68s
  26   5.94266967e+02  5.94266994e+02  1.19e-05 2.91e-13  1.80e-11    70s
  27   5.94266963e+02  5.94266994e+02  1.01e-05 2.86e-13  1.69e-11    72s
  28   5.94266997e+02  5.94266994e+02  1.21e-05 2.45e-13  1.27e-11    74s
  29   5.94266997e+02  5.94266994e+02  1.15e-05 1.47e-13  1.23e-11    76s
  30   5.94266982e+02  5.94266994e+02  7.42e-06 8.96e-14  1.07e-11    78s
  31   5.94266986e+02  5.94266994e+02  7.98e-06 9.73e-14  1.06e-11    81s
  32   5.94266983e+02  5.94266994e+02  5.86e-06 7.20e-14  2.27e-12    85s
  33   5.94267027e+02  5.94266994e+02  5.81e-06 1.22e-13  2.04e-12    87s
  34   5.94267022e+02  5.94266994e+02  6.93e-06 1.32e-13  1.28e-13    90s
  35   5.94267079e+02  5.94266994e+02  8.45e-06 1.19e-13  4.99e-13    93s
  36   5.94266957e+02  5.94266994e+02  1.36e-05 1.30e-13  8.79e-14    95s
  37   5.94266852e+02  5.94266994e+02  1.81e-05 1.05e-13  5.54e-14    97s
  38   5.94266902e+02  5.94266994e+02  1.77e-05 2.52e-13  3.48e-14    99s
  39   5.94267038e+02  5.94266994e+02  1.58e-05 1.43e-13  1.47e-14   101s
  40   5.94266980e+02  5.94266994e+02  9.05e-06 1.73e-13  3.02e-15   102s
  41   5.94266979e+02  5.94266994e+02  9.06e-06 9.43e-14  4.18e-15   106s
  42   5.94266979e+02  5.94266994e+02  9.04e-06 1.19e-13  4.18e-15   112s
  43   5.94266940e+02  5.94266994e+02  2.39e-05 1.22e-13  3.72e-15   114s
  44   5.94266952e+02  5.94266994e+02  2.26e-05 7.37e-14  3.14e-15   118s
  45   5.94267019e+02  5.94266994e+02  1.33e-05 7.71e-14  3.74e-14   120s
  46   5.94266999e+02  5.94266994e+02  7.84e-06 1.12e-13  9.33e-15   122s
  47   5.94266999e+02  5.94266994e+02  1.41e-05 1.20e-13  1.73e-15   123s
  48   5.94266984e+02  5.94266994e+02  9.51e-06 7.62e-14  5.61e-16   125s
  49   5.94266950e+02  5.94266994e+02  8.94e-06 1.15e-13  2.79e-15   126s
  50   5.94267049e+02  5.94266994e+02  1.39e-05 9.35e-14  3.70e-15   128s
  51   5.94267011e+02  5.94266994e+02  6.32e-06 1.11e-13  1.55e-14   130s

Barrier performed 51 iterations in 129.85 seconds (182.17 work units)
Sub-optimal termination - objective 5.94266951e+02

Optimization finished!
Restarting optimization for throughput iteration 1...
Gurobi Optimizer version 10.0.2 build v10.0.2rc0 (mac64[arm])

CPU model: Apple M1
Thread count: 8 physical cores, 8 logical processors, using up to 8 threads

Optimize a model with 28248 rows, 1913 columns and 54038424 nonzeros
Model fingerprint: 0x1db8ce5b
Coefficient statistics:
  Matrix range     [1e-12, 7e-04]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-05, 4e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve time: 12.29s
Presolved: 1913 rows, 30161 columns, 54040337 nonzeros
Ordering time: 0.01s

Barrier statistics:
 AA' NZ     : 1.829e+06
 Factor NZ  : 1.831e+06 (roughly 30 MB of memory)
 Factor Ops : 2.335e+09 (less than 1 second per iteration)
 Threads    : 8

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   5.80823828e+03  0.00000000e+00  0.00e+00 0.00e+00  5.57e-01    16s
   1   3.38972782e+03  2.92863674e+02  0.00e+00 4.32e-02  1.54e-01    18s
   2   1.92921242e+03  3.75792897e+02  0.00e+00 2.93e-02  7.22e-02    19s
   3   1.10028894e+03  4.20248007e+02  0.00e+00 1.36e-02  2.72e-02    21s
   4   5.96669937e+02  4.47202414e+02  0.00e+00 3.04e-03  5.15e-03    23s
   5   4.99623914e+02  4.55876222e+02  0.00e+00 1.23e-03  1.49e-03    25s
   6   4.72199779e+02  4.61334899e+02  0.00e+00 4.38e-04  3.76e-04    27s
   7   4.67842922e+02  4.63404138e+02  0.00e+00 2.01e-04  1.55e-04    29s
   8   4.65741353e+02  4.64672169e+02  0.00e+00 4.84e-05  3.73e-05    31s
   9   4.65241348e+02  4.65028573e+02  0.00e+00 1.00e-05  7.45e-06    33s
  10   4.65151984e+02  4.65105115e+02  3.19e-07 2.89e-06  1.70e-06    35s
  11   4.65136355e+02  4.65124730e+02  1.04e-06 7.72e-07  4.25e-07    36s
  12   4.65133662e+02  4.65128267e+02  1.58e-06 4.18e-07  2.02e-07    38s
  13   4.65132852e+02  4.65131288e+02  4.75e-06 1.00e-07  5.69e-08    39s
  14   4.65132390e+02  4.65131885e+02  1.37e-05 3.93e-08  2.09e-08    41s
  15   4.65132268e+02  4.65132203e+02  1.91e-05 6.89e-09  3.66e-09    42s
  16   4.65132190e+02  4.65132261e+02  2.46e-05 1.08e-09  5.12e-10    44s
  17   4.65132184e+02  4.65132265e+02  2.63e-05 7.78e-10  3.85e-10    46s
  18   4.65132196e+02  4.65132267e+02  2.56e-05 5.54e-10  2.88e-10    48s
  19   4.65132202e+02  4.65132267e+02  2.54e-05 5.29e-10  2.76e-10    50s
  20   4.65132349e+02  4.65132270e+02  3.46e-05 2.66e-10  1.51e-10    52s
  21   4.65132441e+02  4.65132270e+02  2.69e-05 2.50e-10  1.31e-10    54s
  22   4.65132287e+02  4.65132271e+02  2.83e-05 1.62e-10  8.60e-11    58s
  23   4.65132314e+02  4.65132272e+02  2.56e-05 6.17e-11  4.73e-11    61s
  24   4.65132340e+02  4.65132272e+02  2.58e-05 4.79e-11  4.01e-11    64s
  25   4.65132163e+02  4.65132272e+02  2.92e-05 1.49e-12  1.24e-11    66s
  26   4.65132233e+02  4.65132272e+02  2.43e-05 6.93e-13  9.89e-12    68s
  27   4.65132206e+02  4.65132272e+02  2.84e-05 6.80e-13  9.06e-12    70s
  28   4.65132222e+02  4.65132272e+02  2.71e-05 5.67e-13  8.64e-12    72s
  29   4.65132269e+02  4.65132271e+02  2.74e-05 6.42e-13  1.43e-11    74s
  30   4.65132169e+02  4.65132271e+02  2.31e-05 4.41e-13  7.64e-13    77s
  31   4.65132245e+02  4.65132271e+02  1.83e-05 2.01e-13  8.68e-13    82s
  32   4.65132252e+02  4.65132271e+02  3.47e-05 2.62e-13  2.11e-12    84s
  33   4.65132192e+02  4.65132271e+02  4.69e-05 3.23e-13  1.92e-12    86s
  34   4.65132582e+02  4.65132271e+02  2.84e-05 1.29e-13  7.15e-13    87s
  35   4.65132575e+02  4.65132271e+02  2.81e-05 1.30e-13  7.63e-13    90s
  36   4.65132548e+02  4.65132271e+02  3.89e-05 1.33e-13  1.00e-12    92s
  37   4.65132677e+02  4.65132271e+02  3.27e-05 6.09e-13  8.89e-13    94s
  38   4.65132505e+02  4.65132271e+02  7.09e-05 5.92e-13  8.18e-13    96s
  39   4.65132491e+02  4.65132271e+02  7.60e-05 6.51e-13  8.21e-13    98s
  40   4.65132457e+02  4.65132271e+02  4.10e-05 1.47e-13  1.10e-12   101s
  41   4.65132389e+02  4.65132271e+02  3.91e-05 1.45e-13  1.11e-12   103s
  42   4.65132545e+02  4.65132271e+02  2.85e-05 9.25e-14  1.01e-12   105s
  43   4.65132367e+02  4.65132271e+02  2.85e-05 8.91e-14  4.39e-13   107s
  44   4.65132243e+02  4.65132271e+02  2.97e-05 2.32e-13  1.01e-13   109s
  45   4.65131985e+02  4.65132271e+02  7.07e-05 1.79e-13  3.80e-14   112s
  46   4.65132439e+02  4.65132271e+02  3.60e-05 1.02e-13  1.20e-12   115s
  47   4.65132438e+02  4.65132271e+02  2.96e-05 2.32e-13  1.01e-12   118s
  48   4.65132534e+02  4.65132271e+02  3.58e-05 1.76e-13  1.83e-12   120s
  49   4.65132327e+02  4.65132271e+02  3.99e-05 1.75e-13  3.99e-13   122s
  50   4.65132310e+02  4.65132271e+02  8.33e-05 6.84e-13  1.19e-12   125s
  51   4.65132334e+02  4.65132271e+02  5.82e-05 2.92e-13  2.05e-12   129s

Barrier performed 51 iterations in 129.15 seconds (185.44 work units)
Sub-optimal termination - objective 4.65132852e+02

WARNING: VerifyWarning: Keyword name 'LS_ALIGN_TOl' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'LS_NUM_STOPS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_START' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'PROG_EDGE' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ITER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'THRPT_ESTIM' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'MAX_THRPT' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_THRDS' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
WARNING: VerifyWarning: Keyword name 'SLV_XOVER' is greater than 8 characters or contains characters not allowed by the FITS standard; a HIERARCH card will be created. [astropy.io.fits.card]
Optimization finished!
