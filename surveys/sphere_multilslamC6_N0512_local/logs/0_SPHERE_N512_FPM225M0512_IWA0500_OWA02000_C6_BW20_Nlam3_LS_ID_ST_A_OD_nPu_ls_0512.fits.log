/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslamC6_N0512_local/drivers/0_SPHERE_N512_FPM225M0512_IWA0500_OWA02000_C6_BW20_Nlam3_LS_ID_ST_A_OD_nPu_ls_0512.fits.py:108: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  dark_zone_mask = circular_aperture(img_owa * 2)(focal_grid) - circular_aperture(img_iwa * 2)(focal_grid)
/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslamC6_N0512_local/drivers/0_SPHERE_N512_FPM225M0512_IWA0500_OWA02000_C6_BW20_Nlam3_LS_ID_ST_A_OD_nPu_ls_0512.fits.py:116: DeprecationWarning: circular_aperture is deprecated. Its new name is make_circular_aperture.
  focal_plane_mask = 1 - evaluate_supersampled(circular_aperture(2 * fpm_radius), focal_mask_grid, 8)
Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 512,
                      'radius': 2.252},
 'image': {'bandwidth': 0.2,
           'contrast': 6,
           'iwa': 5,
           'num_wavelengths': 3,
           'owa': 20,
           'resolution': 2},
 'instrument': {'inst_name': 'SPHERE'},
 'lyot_stop': {'alignment_tolerance': 1,
               'filename': 'SPHERE/sphere_stop_ST_ALC2_nPup0512.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 512,
           'filename': 'SPHERE/pupil=vlt_btw_nPup=512.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslamC6_N0512_local/analysis',
 'drivers_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslamC6_N0512_local/drivers',
 'input_files_dir': '/Users/mndiaye/python/aplc_optimization/masks',
 'log_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslamC6_N0512_local/logs',
 'solution_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslamC6_N0512_local/solutions',
 'survey_dir': '/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslamC6_N0512_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Lyot stop #0:
   Mirror symmetry in x: no
   Searching for mirror symmetric Lyot stops in x...
      Found Lyot stop #2 to fit.
Lyot stop #1:
   Mirror symmetry in x: no
   Searching for mirror symmetric Lyot stops in x...
      Found Lyot stop #3 to fit.
Lyot stop #2:
   Will be ignored due to symmetries with Lyot stops #[0]
Lyot stop #3:
   Will be ignored due to symmetries with Lyot stops #[1]
Lyot stop #0:
   Mirror symmetry in y: no
   Searching for mirror symmetric Lyot stops in y...
      Found Lyot stop #1 to fit.
Lyot stop #1:
   Will be ignored due to symmetries with Lyot stops #[0]
Lyot stop #2:
   Will be ignored due to symmetries with Lyot stops #[0]
Lyot stop #3:
   Will be ignored due to symmetries with Lyot stops #[1]

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: yes

Starting optimization at scale 1 with 50162 variables and 14124 constraints.
Creating model...
Set parameter Username
Academic license - for non-commercial use only - expires 2023-12-14
Set parameter Crossover to value 0
Set parameter Method to value 2
Calculating and adding constraints...
Traceback (most recent call last):
  File "/Users/mndiaye/python/aplc_optimization/surveys/sphere_multilslamC6_N0512_local/drivers/0_SPHERE_N512_FPM225M0512_IWA0500_OWA02000_C6_BW20_Nlam3_LS_ID_ST_A_OD_nPu_ls_0512.fits.py", line 126, in <module>
    apodizer = optimize_aplc(
               ^^^^^^^^^^^^^^
  File "/Users/mndiaye/miniconda3/envs/py311/lib/python3.11/site-packages/aplc_optimization-1.0-py3.11.egg/aplc_optimization/optimizer.py", line 378, in optimize_aplc
    lyot = aplc(Wavefront(x, wavelength))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mndiaye/miniconda3/envs/py311/lib/python3.11/site-packages/hcipy/optics/optical_element.py", line 28, in __call__
    return self.forward(wavefront)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mndiaye/miniconda3/envs/py311/lib/python3.11/site-packages/hcipy/coronagraphy/lyot.py", line 58, in forward
    wf_foc = self.prop.forward(wavefront)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mndiaye/miniconda3/envs/py311/lib/python3.11/site-packages/hcipy/optics/optical_element.py", line 758, in res
    return forward(self, instance_data, wavefront, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mndiaye/miniconda3/envs/py311/lib/python3.11/site-packages/hcipy/propagation/fraunhofer.py", line 73, in forward
    return Wavefront(Field(U_new, instance_data.output_grid), wavefront.wavelength, wavefront.input_stokes_vector)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mndiaye/miniconda3/envs/py311/lib/python3.11/site-packages/hcipy/field/field.py", line 18, in __new__
    def __new__(cls, arr, grid):
   
KeyboardInterrupt
