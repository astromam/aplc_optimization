Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.5},
 'image': {'bandwidth': 0.2,
           'contrast': 8,
           'iwa': 3.4,
           'num_wavelengths': 2,
           'owa': 8.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0120_OD0982_no_struts_gy_ovsamp4_N0100.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 100,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0100.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_AWS_test/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_AWS_test/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_AWS_test/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_AWS_test/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_AWS_test'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 3501 variables and 664 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/2; Variable 1000/3501
Wavelength 1/2; Variable 2000/3501
Wavelength 1/2; Variable 3000/3501
Wavelength 2/2; Variable 1000/3501
Wavelength 2/2; Variable 2000/3501
Wavelength 2/2; Variable 3000/3501
Start optimization...
Optimize a model with 1328 rows, 3501 columns and 4649328 nonzeros
Coefficient statistics:
  Matrix range     [7e-12, 6e-04]
  Objective range  [1e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-04, 1e-04]
Presolve removed 664 rows and 0 columns
Presolve time: 1.32s
Presolved: 664 rows, 4165 columns, 2325328 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.201e+05
 Factor NZ  : 2.208e+05 (roughly 4 MBytes of memory)
 Factor Ops : 9.781e+07 (less than 1 second per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.67461524e+05  7.67679525e+03  7.80e+00 0.00e+00  2.32e+02     2s
   1   3.53309197e+03  7.62408964e+03  4.06e-02 2.50e-12  1.92e+00     2s
   2   2.35538625e+03  4.73262566e+03  1.38e-02 1.42e-10  6.31e-01     2s
   3   2.04907840e+03  2.63590196e+03  2.39e-03 2.31e-10  1.09e-01     2s
   4   1.97271204e+03  2.10172711e+03  4.19e-04 2.32e-10  2.07e-02     2s
   5   1.98093936e+03  2.03908852e+03  1.53e-04 2.47e-10  8.77e-03     2s
   6   1.98621310e+03  2.00832032e+03  6.72e-05 3.11e-10  3.42e-03     2s
   7   1.98735921e+03  2.00506176e+03  5.59e-05 2.22e-10  2.76e-03     2s
   8   1.99105736e+03  1.99945908e+03  2.12e-05 2.36e-10  1.25e-03     2s
   9   1.99198169e+03  1.99809924e+03  1.54e-05 2.25e-10  9.08e-04     3s
  10   1.99269266e+03  1.99698159e+03  1.09e-05 1.97e-10  6.37e-04     3s
  11   1.99339908e+03  1.99615617e+03  6.75e-06 1.78e-10  4.07e-04     3s
  12   1.99391068e+03  1.99532297e+03  3.86e-06 2.74e-10  2.13e-04     3s
  13   1.99429535e+03  1.99504214e+03  1.82e-06 4.41e-10  1.10e-04     3s
  14   1.99445673e+03  1.99477128e+03  9.97e-07 2.26e-10  4.90e-05     3s
  15   1.99459555e+03  1.99470465e+03  3.41e-07 2.29e-10  1.69e-05     3s
  16   1.99466049e+03  1.99468576e+03  5.02e-08 2.60e-10  3.60e-06     3s
  17   1.99466679e+03  1.99467774e+03  2.69e-08 2.40e-10  1.62e-06     3s
  18   1.99467284e+03  1.99467539e+03  4.21e-09 3.22e-10  3.54e-07     3s
  19   1.99467384e+03  1.99467432e+03  9.94e-10 3.26e-10  6.93e-08     4s
  20   1.99467416e+03  1.99467417e+03  8.06e-14 2.72e-10  9.88e-10     4s

Barrier solved model in 20 iterations and 3.69 seconds
Optimal objective 1.99467416e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 1328 rows, 3501 columns and 4649328 nonzeros
Coefficient statistics:
  Matrix range     [7e-12, 6e-04]
  Objective range  [1e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-05, 7e-05]
Presolve removed 664 rows and 0 columns
Presolve time: 1.34s
Presolved: 664 rows, 4165 columns, 2325328 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.201e+05
 Factor NZ  : 2.208e+05 (roughly 4 MBytes of memory)
 Factor Ops : 9.781e+07 (less than 1 second per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   3.67461524e+05  7.58836271e+03  7.80e+00 0.00e+00  2.32e+02     2s
   1   3.63747972e+03  7.53596218e+03  4.28e-02 2.73e-12  1.97e+00     2s
   2   2.22237610e+03  4.21951001e+03  1.11e-02 1.59e-10  5.05e-01     2s
   3   2.00068645e+03  2.35722999e+03  1.83e-03 2.05e-10  7.02e-02     2s
   4   1.94880338e+03  2.03109924e+03  1.90e-04 2.83e-10  1.22e-02     2s
   5   1.95917569e+03  1.99508760e+03  8.66e-05 2.45e-10  5.31e-03     2s
   6   1.96587521e+03  1.98166146e+03  3.81e-05 2.69e-10  2.33e-03     2s
   7   1.96950074e+03  1.97782776e+03  1.64e-05 2.06e-10  1.19e-03     3s
   8   1.97069318e+03  1.97610597e+03  1.04e-05 2.33e-10  7.68e-04     3s
   9   1.97165369e+03  1.97500255e+03  6.06e-06 3.58e-10  4.71e-04     3s
  10   1.97217771e+03  1.97401603e+03  3.77e-06 2.23e-10  2.63e-04     3s
  11   1.97265466e+03  1.97355758e+03  1.82e-06 2.67e-10  1.29e-04     3s
  12   1.97280888e+03  1.97334691e+03  1.19e-06 2.13e-10  7.80e-05     3s
  13   1.97298415e+03  1.97319172e+03  5.07e-07 2.77e-10  3.06e-05     3s
  14   1.97307475e+03  1.97314480e+03  1.69e-07 2.52e-10  1.03e-05     3s
  15   1.97312107e+03  1.97313101e+03  1.46e-08 2.72e-10  1.36e-06     3s
  16   1.97312606e+03  1.97312708e+03  6.29e-10 3.07e-10  1.30e-07     3s
  17   1.97312640e+03  1.97312644e+03  1.81e-11 2.57e-10  4.97e-09     4s
  18   1.97312641e+03  1.97312641e+03  2.25e-12 2.66e-10  3.00e-10     4s

Barrier solved model in 18 iterations and 3.72 seconds
Optimal objective 1.97312641e+03

Optimization finished!
Traceback (most recent call last):
  File "/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_AWS_test/drivers/0_LUVOIR_N100_FPM350M050_IWA0340_OWA00800_C8_BW20_Nlam2_LS_IDD0120_OD0982_no_ls_struts.py", line 143, in <module>
    fits.writeto(solution_fname, ff, hdr, overwrite=True)
  File "/Users/kstlaurent/anaconda3/envs/SCDA2/lib/python3.6/site-packages/astropy/utils/decorators.py", line 521, in wrapper
    return function(*args, **kwargs)
  File "/Users/kstlaurent/anaconda3/envs/SCDA2/lib/python3.6/site-packages/astropy/io/fits/convenience.py", line 416, in writeto
    hdu = _makehdu(data, header)
  File "/Users/kstlaurent/anaconda3/envs/SCDA2/lib/python3.6/site-packages/astropy/io/fits/convenience.py", line 1042, in _makehdu
    raise KeyError('Data must be a numpy array.')
KeyError: 'Data must be a numpy array.'
