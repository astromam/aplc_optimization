Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.5},
 'image': {'bandwidth': 0.1,
           'contrast': 10,
           'iwa': 3.4,
           'num_wavelengths': 4,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0120_OD0982_no_struts_gy_ovsamp1_N0256.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 256,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0256.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_baseline_N0256_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_baseline_N0256_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_baseline_N0256_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_baseline_N0256_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_baseline_N0256_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 22503 variables and 3312 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/4; Variable 1000/22503
Wavelength 1/4; Variable 2000/22503
Wavelength 1/4; Variable 3000/22503
Wavelength 1/4; Variable 4000/22503
Wavelength 1/4; Variable 5000/22503
Wavelength 1/4; Variable 6000/22503
Wavelength 1/4; Variable 7000/22503
Wavelength 1/4; Variable 8000/22503
Wavelength 1/4; Variable 9000/22503
Wavelength 1/4; Variable 10000/22503
Wavelength 1/4; Variable 11000/22503
Wavelength 1/4; Variable 12000/22503
Wavelength 1/4; Variable 13000/22503
Wavelength 1/4; Variable 14000/22503
Wavelength 1/4; Variable 15000/22503
Wavelength 1/4; Variable 16000/22503
Wavelength 1/4; Variable 17000/22503
Wavelength 1/4; Variable 18000/22503
Wavelength 1/4; Variable 19000/22503
Wavelength 1/4; Variable 20000/22503
Wavelength 1/4; Variable 21000/22503
Wavelength 1/4; Variable 22000/22503
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 2/4; Variable 1000/22503
Wavelength 2/4; Variable 2000/22503
Wavelength 2/4; Variable 3000/22503
Wavelength 2/4; Variable 4000/22503
Wavelength 2/4; Variable 5000/22503
Wavelength 2/4; Variable 6000/22503
Wavelength 2/4; Variable 7000/22503
Wavelength 2/4; Variable 8000/22503
Wavelength 2/4; Variable 9000/22503
Wavelength 2/4; Variable 10000/22503
Wavelength 2/4; Variable 11000/22503
Wavelength 2/4; Variable 12000/22503
Wavelength 2/4; Variable 13000/22503
Wavelength 2/4; Variable 14000/22503
Wavelength 2/4; Variable 15000/22503
Wavelength 2/4; Variable 16000/22503
Wavelength 2/4; Variable 17000/22503
Wavelength 2/4; Variable 18000/22503
Wavelength 2/4; Variable 19000/22503
Wavelength 2/4; Variable 20000/22503
Wavelength 2/4; Variable 21000/22503
Wavelength 2/4; Variable 22000/22503
Wavelength 3/4; Variable 1000/22503
Wavelength 3/4; Variable 2000/22503
Wavelength 3/4; Variable 3000/22503
Wavelength 3/4; Variable 4000/22503
Wavelength 3/4; Variable 5000/22503
Wavelength 3/4; Variable 6000/22503
Wavelength 3/4; Variable 7000/22503
Wavelength 3/4; Variable 8000/22503
Wavelength 3/4; Variable 9000/22503
Wavelength 3/4; Variable 10000/22503
Wavelength 3/4; Variable 11000/22503
Wavelength 3/4; Variable 12000/22503
Wavelength 3/4; Variable 13000/22503
Wavelength 3/4; Variable 14000/22503
Wavelength 3/4; Variable 15000/22503
Wavelength 3/4; Variable 16000/22503
Wavelength 3/4; Variable 17000/22503
Wavelength 3/4; Variable 18000/22503
Wavelength 3/4; Variable 19000/22503
Wavelength 3/4; Variable 20000/22503
Wavelength 3/4; Variable 21000/22503
Wavelength 3/4; Variable 22000/22503
Wavelength 4/4; Variable 1000/22503
Wavelength 4/4; Variable 2000/22503
Wavelength 4/4; Variable 3000/22503
Wavelength 4/4; Variable 4000/22503
Wavelength 4/4; Variable 5000/22503
Wavelength 4/4; Variable 6000/22503
Wavelength 4/4; Variable 7000/22503
Wavelength 4/4; Variable 8000/22503
Wavelength 4/4; Variable 9000/22503
Wavelength 4/4; Variable 10000/22503
Wavelength 4/4; Variable 11000/22503
Wavelength 4/4; Variable 12000/22503
Wavelength 4/4; Variable 13000/22503
Wavelength 4/4; Variable 14000/22503
Wavelength 4/4; Variable 15000/22503
Wavelength 4/4; Variable 16000/22503
Wavelength 4/4; Variable 17000/22503
Wavelength 4/4; Variable 18000/22503
Wavelength 4/4; Variable 19000/22503
Wavelength 4/4; Variable 20000/22503
Wavelength 4/4; Variable 21000/22503
Wavelength 4/4; Variable 22000/22503
Start optimization...
Optimize a model with 6624 rows, 22503 columns and 149059864 nonzeros
Coefficient statistics:
  Matrix range     [1e-13, 9e-05]
  Objective range  [6e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 10s) ...
Presolve removed 0 rows and 0 columns (presolve time = 14s) ...
Presolve removed 0 rows and 0 columns (presolve time = 24s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 3312 rows and 0 columns (presolve time = 54s) ...
Presolve removed 3312 rows and 0 columns
Presolve time: 55.22s
Presolved: 3312 rows, 25815 columns, 74533240 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 5.483e+06
 Factor NZ  : 5.486e+06 (roughly 60 MBytes of memory)
 Factor Ops : 1.212e+10 (roughly 1 second per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.62330765e+07  5.49358487e+04  3.10e+01 0.00e+00  1.85e+03    79s
   1   3.78406361e+04  5.48804347e+04  5.24e-02 2.00e-11  3.98e+00    87s
   2   1.72789284e+04  4.23804645e+04  1.30e-02 1.66e-09  1.23e+00    95s
   3   1.35693999e+04  2.42398908e+04  4.47e-03 4.03e-09  3.75e-01   104s
   4   1.24551870e+04  1.45047772e+04  1.07e-03 5.32e-09  6.59e-02   112s
   5   1.23032000e+04  1.31174945e+04  5.06e-04 8.84e-09  2.67e-02   121s
   6   1.22897767e+04  1.27930592e+04  3.66e-04 7.67e-09  1.74e-02   129s
   7   1.22888694e+04  1.25671217e+04  2.30e-04 1.12e-08  1.01e-02   138s
   8   1.22825750e+04  1.24575397e+04  1.51e-04 7.77e-09  6.47e-03   146s
   9   1.22815058e+04  1.24076246e+04  1.05e-04 8.09e-09  4.57e-03   155s
  10   1.22814943e+04  1.23758664e+04  8.44e-05 9.77e-09  3.53e-03   164s
  11   1.22814701e+04  1.23507308e+04  6.21e-05 1.06e-08  2.59e-03   172s
  12   1.22832768e+04  1.23269298e+04  4.57e-05 1.17e-08  1.76e-03   181s
  13   1.22847538e+04  1.23151472e+04  3.16e-05 8.06e-09  1.22e-03   190s
  14   1.22866245e+04  1.23037532e+04  2.01e-05 1.15e-08  7.35e-04   199s
  15   1.22874338e+04  1.22956107e+04  1.13e-05 1.00e-08  3.84e-04   209s
  16   1.22879864e+04  1.22926116e+04  7.08e-06 1.08e-08  2.31e-04   219s
  17   1.22883804e+04  1.22910900e+04  4.27e-06 1.04e-08  1.38e-04   227s
  18   1.22886848e+04  1.22896977e+04  2.02e-06 1.20e-08  6.01e-05   237s
  19   1.22887869e+04  1.22894256e+04  1.52e-06 1.27e-08  4.28e-05   246s
  20   1.22889819e+04  1.22892909e+04  5.63e-07 1.04e-08  1.73e-05   254s
  21   1.22891110e+04  1.22891649e+04  3.90e-08 1.70e-08  1.83e-06   265s
  22   1.22891409e+04  1.22891443e+04  7.48e-10 1.15e-08  8.05e-08   275s
  23   1.22891429e+04  1.22891434e+04  1.02e-10 1.38e-08  1.02e-08   285s
  24   1.22891433e+04  1.22891433e+04  2.69e-12 1.32e-08  3.66e-10   295s

Barrier solved model in 24 iterations and 294.89 seconds
Optimal objective 1.22891433e+04

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 6624 rows, 22503 columns and 149059864 nonzeros
Coefficient statistics:
  Matrix range     [1e-13, 9e-05]
  Objective range  [6e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 10s) ...
Presolve removed 0 rows and 0 columns (presolve time = 14s) ...
Presolve removed 0 rows and 0 columns (presolve time = 24s) ...
Presolve removed 0 rows and 0 columns (presolve time = 48s) ...
Presolve removed 3312 rows and 0 columns (presolve time = 53s) ...
Presolve removed 3312 rows and 0 columns
Presolve time: 54.10s
Presolved: 3312 rows, 25815 columns, 74533240 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 5.483e+06
 Factor NZ  : 5.486e+06 (roughly 60 MBytes of memory)
 Factor Ops : 1.212e+10 (roughly 1 second per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.62330765e+07  5.45226286e+04  3.10e+01 0.00e+00  1.85e+03    78s
   1   3.83905056e+04  5.44673530e+04  5.34e-02 2.18e-11  4.04e+00    86s
   2   1.77438409e+04  4.21717965e+04  1.39e-02 1.90e-09  1.28e+00    94s
   3   1.34315842e+04  2.44565044e+04  4.20e-03 4.81e-09  3.77e-01   102s
   4   1.27844607e+04  1.49670584e+04  1.91e-03 6.35e-09  9.32e-02   111s
   5   1.24773320e+04  1.33498445e+04  1.02e-03 9.53e-09  4.15e-02   119s
   6   1.24199883e+04  1.28627568e+04  8.22e-04 1.23e-08  2.77e-02   127s
   7   1.23772248e+04  1.26732019e+04  5.89e-04 1.26e-08  1.99e-02   136s
   8   1.23396096e+04  1.25056892e+04  4.84e-04 1.28e-07  1.58e-02   145s
   9   1.23156191e+04  1.23721498e+04  4.28e-04 3.92e-08  1.33e-02   154s
  10   1.22984186e+04  1.23009854e+04  4.02e-04 8.66e-07  1.23e-02   163s
  11   1.22624356e+04  1.21861221e+04  3.60e-04 1.34e-06  1.11e-02   171s
  12   1.22181762e+04  1.20542302e+04  3.26e-04 1.65e-06  1.01e-02   180s
  13   1.21898131e+04  1.18760605e+04  3.10e-04 9.72e-07  9.24e-03   188s
  14   1.20843014e+04  1.17300553e+04  2.68e-04 4.14e-06  8.37e-03   199s
  15   1.20164562e+04  1.15848255e+04  2.50e-04 8.57e-07  7.57e-03   208s
  16   1.19086517e+04  1.14938590e+04  2.16e-04 1.16e-06  6.56e-03   217s
  17   1.17707678e+04  1.14358670e+04  1.73e-04 7.30e-07  5.70e-03   227s
  18   1.17089312e+04  1.13967835e+04  1.55e-04 6.85e-07  5.21e-03   237s
  19   1.16687641e+04  1.13448970e+04  1.44e-04 9.56e-06  4.52e-03   246s
  20   1.16298371e+04  1.13109442e+04  1.33e-04 2.14e-05  4.05e-03   255s
  21   1.15944098e+04  1.12910699e+04  1.23e-04 3.30e-06  3.76e-03   264s
  22   1.15408400e+04  1.12545258e+04  1.09e-04 9.82e-07  3.18e-03   274s
  23   1.15135403e+04  1.12302217e+04  1.02e-04 1.32e-06  2.82e-03   284s
  24   1.14865065e+04  1.12092355e+04  9.47e-05 8.11e-07  2.48e-03   293s
  25   1.14556174e+04  1.11988636e+04  8.67e-05 3.61e-07  2.27e-03   302s
  26   1.14351623e+04  1.11857726e+04  8.14e-05 9.48e-07  2.06e-03   312s
  27   1.14016433e+04  1.11642021e+04  7.29e-05 1.56e-06  1.68e-03   322s
  28   1.13889966e+04  1.11580866e+04  6.97e-05 5.40e-07  1.56e-03   332s
  29   1.13630772e+04  1.11451743e+04  6.32e-05 3.93e-06  1.32e-03   342s
  30   1.13430617e+04  1.11394483e+04  5.82e-05 6.81e-06  1.18e-03   353s
  31   1.13130616e+04  1.11335753e+04  5.07e-05 6.45e-06  1.01e-03   363s
  32   1.12911052e+04  1.11278807e+04  4.54e-05 4.76e-05  8.96e-04   373s
  33   1.12811620e+04  1.11241898e+04  4.30e-05 5.13e-05  8.15e-04   383s
  34   1.12668022e+04  1.11221835e+04  3.94e-05 3.68e-05  7.51e-04   393s
  35   1.12430325e+04  1.11185719e+04  3.36e-05 4.14e-05  6.37e-04   402s
  36   1.12351677e+04  1.11151432e+04  3.17e-05 2.53e-05  5.61e-04   411s
  37   1.12219070e+04  1.11136155e+04  2.86e-05 2.81e-05  5.09e-04   421s
  38   1.12133490e+04  1.11126770e+04  2.65e-05 2.06e-05  4.76e-04   430s
  39   1.11974140e+04  1.11097782e+04  2.27e-05 5.19e-06  3.82e-04   440s
  40   1.11876816e+04  1.11082904e+04  2.03e-05 8.49e-07  3.30e-04   451s
  41   1.11803443e+04  1.11066402e+04  1.86e-05 4.04e-05  2.88e-04   462s
  42   1.11673497e+04  1.11055435e+04  1.55e-05 2.30e-06  2.40e-04   472s
  43   1.11603260e+04  1.11046414e+04  1.39e-05 5.36e-06  2.08e-04   481s
  44   1.11497240e+04  1.11038594e+04  1.13e-05 7.97e-07  1.65e-04   492s
  45   1.11431399e+04  1.11033532e+04  9.80e-06 1.80e-06  1.41e-04   501s
  46   1.11359932e+04  1.11025843e+04  8.12e-06 4.53e-05  1.10e-04   512s
  47   1.11302280e+04  1.11021511e+04  6.76e-06 1.11e-05  8.77e-05   522s
  48   1.11257064e+04  1.11018767e+04  5.69e-06 4.86e-05  7.17e-05   533s
  49   1.11200661e+04  1.11016183e+04  4.38e-06 1.62e-04  5.33e-05   544s
  50   1.11154834e+04  1.11014353e+04  3.32e-06 2.38e-04  3.94e-05   554s
  51   1.11134874e+04  1.11013736e+04  2.86e-06 2.01e-04  3.40e-05   563s
  52   1.11112407e+04  1.11013292e+04  2.34e-06 1.89e-04  2.81e-05   572s
  53   1.11099664e+04  1.11012833e+04  2.05e-06 1.43e-04  2.44e-05   582s
  54   1.11091109e+04  1.11012355e+04  1.85e-06 8.77e-05  2.17e-05   590s
  55   1.11081098e+04  1.11012021e+04  1.62e-06 5.01e-05  1.88e-05   600s
  56   1.11072446e+04  1.11011850e+04  1.42e-06 1.50e-05  1.66e-05   609s
  57   1.11068113e+04  1.11011588e+04  1.33e-06 1.26e-05  1.51e-05   617s
  58   1.11057934e+04  1.11011458e+04  1.09e-06 1.34e-05  1.26e-05   627s
  59   1.11056179e+04  1.11011317e+04  1.05e-06 1.40e-05  1.19e-05   636s
  60   1.11051760e+04  1.11011252e+04  9.49e-07 1.45e-05  1.08e-05   646s
  61   1.11046661e+04  1.11011110e+04  8.31e-07 8.79e-05  9.35e-06   655s
  62   1.11035693e+04  1.11011023e+04  5.77e-07 8.19e-05  6.55e-06   664s
  63   1.11029564e+04  1.11010926e+04  4.36e-07 4.55e-05  4.98e-06   674s
  64   1.11024880e+04  1.11010833e+04  3.28e-07 1.83e-05  3.72e-06   684s
  65   1.11021574e+04  1.11010767e+04  2.52e-07 1.04e-05  2.80e-06   695s
  66   1.11017487e+04  1.11010700e+04  1.58e-07 2.14e-05  1.73e-06   706s
  67   1.11014912e+04  1.11010655e+04  9.86e-08 4.43e-05  1.05e-06   717s
  68   1.11013131e+04  1.11010634e+04  5.75e-08 1.14e-04  5.93e-07   727s
  69   1.11011808e+04  1.11010627e+04  2.74e-08 1.47e-04  2.87e-07   738s
  70   1.11011051e+04  1.11010620e+04  9.74e-09 7.13e-05  1.03e-07   748s
  71   1.11010661e+04  1.11010618e+04  8.80e-10 3.19e-05  1.25e-08   758s
  72   1.11010618e+04  1.11010617e+04  4.56e-12 9.22e-06  4.98e-10   769s

Barrier solved model in 72 iterations and 768.53 seconds
Optimal objective 1.11010618e+04

Optimization finished!
