Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.5},
 'image': {'bandwidth': 0.2,
           'contrast': 8,
           'iwa': 3.4,
           'num_wavelengths': 2,
           'owa': 8.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0120_OD0982_no_struts_gy_ovsamp4_N0100.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 4},
 'pupil': {'N': 100,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0100.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_progressive_test_telserv3/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_progressive_test_telserv3/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_progressive_test_telserv3/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_progressive_test_telserv3/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0100_progressive_test_telserv3'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 4 with 228 variables and 664 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Start optimization...
Optimize a model with 1328 rows, 228 columns and 302784 nonzeros
Coefficient statistics:
  Matrix range     [2e-09, 9e-03]
  Objective range  [2e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-04, 1e-04]
Presolve time: 0.05s
Presolved: 228 rows, 1556 columns, 303012 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.588e+04
 Factor NZ  : 2.611e+04 (roughly 1 MByte of memory)
 Factor Ops : 3.977e+06 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.79559960e+02  0.00000000e+00  0.00e+00 0.00e+00  6.88e-01     0s
   1   2.44781497e+02  5.96680873e+01  0.00e+00 3.14e-02  1.44e-01     0s
   2   1.44983331e+02  9.53793838e+01  0.00e+00 1.15e-02  3.86e-02     0s
   3   1.18309315e+02  1.00079840e+02  0.00e+00 1.98e-03  1.15e-02     0s
   4   1.07787456e+02  1.00940834e+02  0.00e+00 1.02e-03  4.32e-03     0s
   5   1.05139779e+02  1.01412161e+02  0.00e+00 5.40e-04  2.32e-03     0s
   6   1.03204079e+02  1.01753687e+02  0.00e+00 2.78e-04  9.26e-04     0s
   7   1.02406118e+02  1.01917978e+02  0.00e+00 1.56e-04  3.35e-04     0s
   8   1.02249353e+02  1.02007089e+02  0.00e+00 8.45e-05  1.69e-04     0s
   9   1.02160525e+02  1.02068520e+02  0.00e+00 3.24e-05  6.42e-05     0s
  10   1.02124362e+02  1.02093516e+02  0.00e+00 1.10e-05  2.17e-05     0s
  11   1.02111388e+02  1.02101888e+02  0.00e+00 3.30e-06  6.65e-06     0s
  12   1.02108027e+02  1.02104573e+02  0.00e+00 1.12e-06  2.38e-06     0s
  13   1.02106103e+02  1.02105595e+02  0.00e+00 2.52e-07  3.89e-07     0s
  14   1.02105968e+02  1.02105845e+02  0.00e+00 4.23e-08  8.64e-08     0s
  15   1.02105910e+02  1.02105904e+02  5.66e-08 2.39e-09  4.17e-09     0s
  16   1.02105908e+02  1.02105908e+02  1.55e-07 3.83e-10  5.63e-10     0s
  17   1.02105908e+02  1.02105908e+02  4.53e-08 6.04e-15  5.28e-12     0s

Barrier solved model in 17 iterations and 0.18 seconds
Optimal objective 1.02105908e+02

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 1328 rows, 228 columns and 302784 nonzeros
Coefficient statistics:
  Matrix range     [2e-09, 9e-03]
  Objective range  [2e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [6e-05, 6e-05]
Presolve time: 0.05s
Presolved: 228 rows, 1556 columns, 303012 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.588e+04
 Factor NZ  : 2.611e+04 (roughly 1 MByte of memory)
 Factor Ops : 3.977e+06 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69094527e+02  0.00000000e+00  0.00e+00 0.00e+00  6.79e-01     0s
   1   2.34981138e+02  5.82639068e+01  0.00e+00 3.54e-02  1.45e-01     0s
   2   1.40092235e+02  9.29872728e+01  0.00e+00 1.36e-02  4.20e-02     0s
   3   1.09996777e+02  9.71034590e+01  0.00e+00 3.90e-03  1.05e-02     0s
   4   1.02275022e+02  9.79803760e+01  0.00e+00 1.85e-03  3.74e-03     0s
   5   1.00359818e+02  9.84310864e+01  0.00e+00 8.12e-04  1.58e-03     0s
   6   9.94446970e+01  9.85744579e+01  0.00e+00 3.48e-04  6.92e-04     0s
   7   9.90012533e+01  9.86346363e+01  0.00e+00 1.83e-04  3.10e-04     0s
   8   9.88054449e+01  9.86648372e+01  0.00e+00 6.57e-05  1.16e-04     0s
   9   9.87215521e+01  9.86761044e+01  0.00e+00 2.70e-05  4.11e-05     0s
  10   9.86999420e+01  9.86815107e+01  0.00e+00 1.08e-05  1.65e-05     0s
  11   9.86871709e+01  9.86845003e+01  0.00e+00 1.32e-06  2.28e-06     0s
  12   9.86858968e+01  9.86851675e+01  0.00e+00 3.50e-07  6.17e-07     0s
  13   9.86854670e+01  9.86854105e+01  0.00e+00 2.02e-08  4.38e-08     0s
  14   9.86854292e+01  9.86854280e+01  3.65e-09 2.52e-10  8.53e-10     0s
  15   9.86854284e+01  9.86854283e+01  1.24e-08 5.02e-15  8.54e-13     0s

Barrier solved model in 15 iterations and 0.15 seconds
Optimal objective 9.86854284e+01

Optimization finished!
Starting optimization at scale 2 with 862 variables and 664 constraints.
Creating model...
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Start optimization...
Optimize a model with 1328 rows, 862 columns and 1144736 nonzeros
Coefficient statistics:
  Matrix range     [1e-10, 2e-03]
  Objective range  [5e-03, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-06, 4e-02]
Presolve removed 664 rows and 0 columns
Presolve time: 0.19s
Presolved: 664 rows, 1526 columns, 573032 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.201e+05
 Factor NZ  : 2.208e+05 (roughly 3 MBytes of memory)
 Factor Ops : 9.781e+07 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   2.61614209e+04  1.58718777e+03  2.23e+00 0.00e+00  5.80e+01     0s
   1   6.70033142e+02  1.55087507e+03  2.23e-02 4.55e-13  9.42e-01     0s
   2   5.08540418e+02  7.88827475e+02  6.69e-03 3.55e-11  2.41e-01     0s
   3   4.52623737e+02  5.26354468e+02  1.43e-03 4.89e-11  5.00e-02     0s
   4   4.42290855e+02  4.69390798e+02  3.00e-04 6.22e-11  1.29e-02     0s
   5   4.42473439e+02  4.55049439e+02  1.23e-04 5.15e-11  5.51e-03     0s
   6   4.43160117e+02  4.48401118e+02  5.51e-05 6.07e-11  2.28e-03     0s
   7   4.43745352e+02  4.46028543e+02  2.47e-05 4.76e-11  9.88e-04     0s
   8   4.44065955e+02  4.44752727e+02  8.12e-06 4.70e-11  3.02e-04     0s
   9   4.44165156e+02  4.44472550e+02  3.48e-06 6.36e-11  1.33e-04     0s
  10   4.44230535e+02  4.44325776e+02  8.54e-07 1.14e-10  3.92e-05     0s
  11   4.44248375e+02  4.44287330e+02  2.96e-07 5.53e-11  1.55e-05     0s
  12   4.44252909e+02  4.44265202e+02  1.69e-07 6.54e-11  5.61e-06     0s
  13   4.44258121e+02  4.44260325e+02  2.64e-08 4.35e-11  9.69e-07     0s
  14   4.44259135e+02  4.44259678e+02  2.37e-09 7.26e-11  2.00e-07     0s
  15   4.44259230e+02  4.44259333e+02  1.95e-10 6.62e-11  3.54e-08     0s
  16   4.44259245e+02  4.44259277e+02  3.94e-11 6.56e-11  1.09e-08     0s
  17   4.44259248e+02  4.44259251e+02  3.14e-12 5.83e-11  1.08e-09     0s

Barrier solved model in 17 iterations and 0.39 seconds
Optimal objective 4.44259248e+02

Optimization finished!
Starting optimization at scale 1 with 2148 variables and 664 constraints.
Creating model...
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/2; Variable 1000/2148
Wavelength 1/2; Variable 2000/2148
Wavelength 2/2; Variable 1000/2148
Wavelength 2/2; Variable 2000/2148
Start optimization...
Optimize a model with 1328 rows, 2148 columns and 2852544 nonzeros
Coefficient statistics:
  Matrix range     [7e-12, 6e-04]
  Objective range  [1e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-05, 4e-02]
Presolve removed 664 rows and 0 columns
Presolve time: 0.58s
Presolved: 664 rows, 2812 columns, 1426936 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.201e+05
 Factor NZ  : 2.208e+05 (roughly 3 MBytes of memory)
 Factor Ops : 9.781e+07 (less than 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   2.21403944e+05  4.58314483e+03  5.66e+00 0.00e+00  2.31e+02     1s
   1   1.62940292e+03  4.55224299e+03  1.70e-02 2.50e-12  1.33e+00     1s
   2   1.26724523e+03  2.21268966e+03  8.33e-03 1.26e-10  4.10e-01     1s
   3   9.33883811e+02  1.23195770e+03  1.30e-03 2.31e-10  7.68e-02     1s
   4   8.96205936e+02  9.52314791e+02  2.40e-04 2.07e-10  1.29e-02     1s
   5   8.97473152e+02  9.28857727e+02  1.27e-04 3.16e-10  7.03e-03     1s
   6   8.99100561e+02  9.14940251e+02  5.93e-05 3.10e-10  3.47e-03     1s
   7   9.00306218e+02  9.08829104e+02  3.56e-05 3.08e-10  1.90e-03     1s
   8   9.01540502e+02  9.06132080e+02  1.30e-05 2.12e-10  9.56e-04     1s
   9   9.02106986e+02  9.04366065e+02  6.49e-06 2.40e-10  4.71e-04     1s
  10   9.02533948e+02  9.03393723e+02  2.12e-06 3.31e-10  1.75e-04     1s
  11   9.02682805e+02  9.03067717e+02  9.01e-07 2.44e-10  7.80e-05     1s
  12   9.02756819e+02  9.02900832e+02  3.36e-07 3.42e-10  2.92e-05     1s
  13   9.02790934e+02  9.02836202e+02  9.12e-08 2.81e-10  9.02e-06     1s
  14   9.02802811e+02  9.02811655e+02  1.66e-08 4.03e-10  1.75e-06     1s
  15   9.02804475e+02  9.02807078e+02  7.71e-09 2.10e-10  5.45e-07     1s
  16   9.02805527e+02  9.02806291e+02  2.39e-09 2.31e-10  1.61e-07     1s
  17   9.02805896e+02  9.02806025e+02  5.36e-10 2.68e-10  2.88e-08     1s
  18   9.02806000e+02  9.02806011e+02  6.34e-12 3.75e-10  2.04e-09     1s
  19   9.02806003e+02  9.02806004e+02  7.10e-13 3.39e-10  1.32e-10     1s

Barrier solved model in 19 iterations and 1.02 seconds
Optimal objective 9.02806003e+02

Optimization finished!
/user/kstlaurent/anaconda3/envs/coron_gur/lib/python3.6/site-packages/asdf/extension.py:211: AsdfDeprecationWarning: The module asdf.asdftypes has been deprecated and will be removed in 3.0. Use asdf.types instead. (from astropy.io.misc.asdf.extension.AstropyExtension)
  AsdfDeprecationWarning)
