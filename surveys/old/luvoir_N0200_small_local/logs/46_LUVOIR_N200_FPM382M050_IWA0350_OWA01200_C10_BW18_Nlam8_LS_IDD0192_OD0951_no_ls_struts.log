Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.82},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3.5,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0192_OD0951_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6592 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13184 rows, 13749 columns and 181266812 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 57.24s
Presolved: 6592 rows, 20341 columns, 90639992 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69829571e+06  3.11666878e+04  2.78e+01 1.82e-12  9.21e+02    99s
   1   1.14372479e+04  3.11109428e+04  3.61e-02 4.15e-10  1.83e+00   120s
   2   7.09467260e+03  1.42387991e+04  5.63e-03 4.27e-09  3.10e-01   142s
   3   7.07535318e+03  9.10581871e+03  2.18e-03 3.86e-09  8.50e-02   165s
   4   7.02394650e+03  7.67738084e+03  1.01e-03 6.71e-09  2.80e-02   187s
   5   7.03555332e+03  7.47929958e+03  7.84e-04 6.85e-09  1.95e-02   209s
   6   7.04542673e+03  7.37567065e+03  6.25e-04 9.83e-09  1.47e-02   231s
   7   7.05766024e+03  7.28933188e+03  4.64e-04 6.27e-09  1.05e-02   253s
   8   7.06516201e+03  7.21911974e+03  3.74e-04 6.62e-09  7.52e-03   276s
   9   7.07083426e+03  7.18861394e+03  2.96e-04 6.80e-09  5.83e-03   299s
  10   7.07408952e+03  7.15909387e+03  2.46e-04 1.40e-08  4.50e-03   322s
  11   7.07580598e+03  7.14070124e+03  2.05e-04 1.02e-08  3.59e-03   344s
  12   7.07860080e+03  7.12542861e+03  1.71e-04 1.16e-08  2.80e-03   366s
  13   7.08237020e+03  7.10797916e+03  1.35e-04 8.82e-09  1.93e-03   389s
  14   7.08388582e+03  7.10223857e+03  1.14e-04 8.83e-09  1.55e-03   411s
  15   7.08498294e+03  7.09796269e+03  8.95e-05 1.04e-08  1.18e-03   433s
  16   7.08529793e+03  7.09490709e+03  7.70e-05 1.17e-08  9.74e-04   455s
  17   7.08738126e+03  7.09031076e+03  5.54e-05 1.17e-08  6.03e-04   480s
  18   7.08770170e+03  7.08842535e+03  3.43e-05 1.08e-08  3.47e-04   503s
  19   7.08723935e+03  7.08713049e+03  2.38e-05 6.73e-09  2.26e-04   525s
  20   7.08685274e+03  7.08646638e+03  1.74e-05 9.38e-09  1.58e-04   548s
  21   7.08626046e+03  7.08587708e+03  9.16e-06 1.29e-08  7.86e-05   571s
  22   7.08598822e+03  7.08567705e+03  6.43e-06 1.11e-08  5.41e-05   593s
  23   7.08576873e+03  7.08553282e+03  4.25e-06 2.99e-08  3.50e-05   615s
  24   7.08555629e+03  7.08543870e+03  2.03e-06 1.35e-08  1.66e-05   638s
  25   7.08543973e+03  7.08537364e+03  9.22e-07 1.06e-08  7.24e-06   660s
  26   7.08534940e+03  7.08535418e+03  4.94e-08 3.91e-08  5.92e-07   684s
  27   7.08534810e+03  7.08534905e+03  1.62e-09 1.14e-08  3.89e-08   707s
  28   7.08534824e+03  7.08534830e+03  1.83e-10 1.84e-08  3.36e-09   731s

Barrier solved model in 28 iterations and 731.12 seconds
Optimal objective 7.08534824e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13184 rows, 13749 columns and 181266812 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 56.90s
Presolved: 6592 rows, 20341 columns, 90639992 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69829571e+06  3.07874262e+04  2.78e+01 1.82e-12  9.21e+02    98s
   1   1.14347182e+04  3.07314860e+04  3.61e-02 3.98e-10  1.82e+00   120s
   2   7.25476040e+03  1.39441302e+04  6.78e-03 3.02e-09  3.29e-01   142s
   3   7.20949987e+03  8.91544249e+03  3.09e-03 3.81e-09  9.54e-02   164s
   4   7.03116097e+03  7.73066118e+03  1.19e-03 6.32e-09  3.38e-02   186s
   5   7.01988144e+03  7.45997389e+03  7.34e-04 1.20e-08  2.02e-02   209s
   6   7.01558540e+03  7.37184156e+03  6.27e-04 7.51e-09  1.65e-02   231s
   7   7.01045359e+03  7.30530575e+03  5.16e-04 6.90e-09  1.35e-02   253s
   8   7.00982641e+03  7.20601021e+03  3.82e-04 1.02e-08  9.28e-03   275s
   9   7.00821388e+03  7.14942952e+03  3.30e-04 1.06e-08  7.27e-03   297s
  10   7.00525776e+03  7.11883527e+03  2.78e-04 9.92e-09  5.95e-03   318s
  11   7.00471696e+03  7.09037523e+03  2.35e-04 2.44e-08  4.74e-03   340s
  12   7.00385205e+03  7.05254863e+03  1.84e-04 1.28e-07  3.24e-03   364s
  13   7.00153373e+03  7.03850463e+03  1.48e-04 1.25e-07  2.55e-03   385s
  14   7.00039738e+03  7.02027372e+03  1.06e-04 1.59e-07  1.68e-03   409s
  15   6.99979514e+03  7.01148876e+03  8.89e-05 6.05e-08  1.29e-03   431s
  16   6.99891360e+03  7.00497286e+03  7.18e-05 5.24e-08  9.66e-04   454s
  17   6.99779190e+03  7.00079685e+03  5.86e-05 1.43e-08  7.46e-04   476s
  18   6.99585495e+03  6.99636666e+03  3.81e-05 1.38e-08  4.55e-04   500s
  19   6.99402132e+03  6.99440407e+03  2.54e-05 1.48e-08  3.06e-04   522s
  20   6.99217962e+03  6.99193049e+03  1.34e-05 2.29e-08  1.51e-04   546s
  21   6.99151940e+03  6.99107305e+03  7.73e-06 1.75e-08  7.98e-05   568s
  22   6.99032760e+03  6.99030731e+03  1.16e-06 6.22e-08  1.31e-05   594s
  23   6.99025633e+03  6.99023292e+03  5.16e-07 1.31e-07  5.50e-06   617s
  24   6.99020029e+03  6.99020202e+03  7.23e-08 7.17e-08  8.94e-07   641s
  25   6.99019436e+03  6.99019560e+03  1.20e-08 4.98e-08  1.72e-07   667s
  26   6.99019367e+03  6.99019383e+03  1.17e-09 3.82e-08  1.79e-08   693s
  27   6.99019362e+03  6.99019368e+03  3.03e-10 1.85e-08  4.93e-09   716s

Barrier solved model in 27 iterations and 715.98 seconds
Optimal objective 6.99019362e+03

Optimization finished!
