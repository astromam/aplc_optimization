Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.92},
 'image': {'bandwidth': 0.16,
           'contrast': 10,
           'iwa': 3,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0190_OD0937_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6768 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Start optimization...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [1e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 58.65s
Presolved: 6768 rows, 20517 columns, 93059994 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53990665e+06  3.06329063e+04  2.85e+01 1.82e-12  9.10e+02   101s
   1   9.89832762e+03  3.05794199e+04  2.89e-02 2.80e-10  1.54e+00   124s
   2   7.38262379e+03  1.59510685e+04  8.95e-03 1.94e-09  4.30e-01   147s
   3   7.12599628e+03  9.53353199e+03  2.84e-03 6.86e-09  1.08e-01   171s
   4   6.92632271e+03  7.86932145e+03  8.33e-04 3.80e-08  3.36e-02   194s
   5   6.94346984e+03  7.56011698e+03  4.33e-04 2.49e-08  2.00e-02   218s
   6   6.95585844e+03  7.35642373e+03  2.33e-04 2.28e-08  1.22e-02   241s
   7   6.96772440e+03  7.14374012e+03  1.53e-04 4.19e-08  5.74e-03   265s
   8   6.97716765e+03  7.08903861e+03  1.10e-04 8.01e-09  3.74e-03   289s
   9   6.98580289e+03  7.06318818e+03  8.19e-05 9.68e-09  2.63e-03   312s
  10   6.99037206e+03  7.04825721e+03  6.65e-05 9.43e-09  2.01e-03   335s
  11   6.99567711e+03  7.03128957e+03  4.98e-05 1.15e-08  1.31e-03   359s
  12   6.99878090e+03  7.02631897e+03  4.02e-05 1.21e-08  1.03e-03   382s
  13   7.00181343e+03  7.02082550e+03  3.20e-05 2.19e-08  7.45e-04   406s
  14   7.00472931e+03  7.01660213e+03  2.44e-05 2.37e-08  5.03e-04   430s
  15   7.00715296e+03  7.01489275e+03  1.62e-05 3.73e-08  3.31e-04   453s
  16   7.00954839e+03  7.01295142e+03  7.61e-06 2.40e-08  1.49e-04   478s
  17   7.01054015e+03  7.01255821e+03  4.35e-06 1.21e-08  8.72e-05   501s
  18   7.01105076e+03  7.01214893e+03  2.53e-06 1.75e-08  4.89e-05   525s
  19   7.01142635e+03  7.01178757e+03  1.01e-06 1.21e-08  1.77e-05   550s
  20   7.01156489e+03  7.01172584e+03  5.26e-07 2.00e-08  8.52e-06   573s
  21   7.01168633e+03  7.01170234e+03  1.75e-08 1.46e-08  5.43e-07   599s
  22   7.01169420e+03  7.01169690e+03  2.52e-09 1.25e-08  8.78e-08   623s
  23   7.01169537e+03  7.01169585e+03  4.97e-10 1.56e-08  1.61e-08   647s
  24   7.01169569e+03  7.01169574e+03  1.78e-11 1.54e-08  1.20e-09   672s

Barrier solved model in 24 iterations and 672.33 seconds
Optimal objective 7.01169569e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [1e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 58.37s
Presolved: 6768 rows, 20517 columns, 93059994 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53990665e+06  3.02652651e+04  2.85e+01 1.82e-12  9.10e+02   102s
   1   9.92157087e+03  3.02115916e+04  2.91e-02 2.44e-10  1.54e+00   125s
   2   7.68379900e+03  1.67058479e+04  1.12e-02 2.23e-09  5.11e-01   148s
   3   7.32329948e+03  9.61421608e+03  4.08e-03 4.49e-08  1.32e-01   171s
   4   6.94936260e+03  7.98157917e+03  1.34e-03 1.94e-08  4.52e-02   195s
   5   6.89801842e+03  7.44118324e+03  6.18e-04 1.05e-08  2.09e-02   219s
   6   6.90386562e+03  7.20252571e+03  3.49e-04 9.01e-09  1.11e-02   242s
   7   6.91011415e+03  7.14280629e+03  2.53e-04 1.02e-08  8.37e-03   266s
   8   6.92046493e+03  7.05228117e+03  1.41e-04 9.12e-09  4.63e-03   291s
   9   6.92854191e+03  7.00903951e+03  8.20e-05 1.03e-08  2.77e-03   317s
  10   6.93240789e+03  6.98362928e+03  5.36e-05 8.59e-09  1.77e-03   341s
  11   6.93472958e+03  6.97184909e+03  4.04e-05 1.29e-08  1.29e-03   364s
  12   6.93714113e+03  6.96046605e+03  2.79e-05 1.07e-08  8.33e-04   388s
  13   6.93949954e+03  6.95375586e+03  1.67e-05 2.03e-08  5.05e-04   412s
  14   6.94106594e+03  6.94719026e+03  9.13e-06 1.65e-08  2.35e-04   436s
  15   6.94210947e+03  6.94515313e+03  4.86e-06 1.72e-08  1.20e-04   460s
  16   6.94323694e+03  6.94358169e+03  2.42e-07 1.46e-08  1.07e-05   486s
  17   6.94337231e+03  6.94341131e+03  1.98e-08 3.38e-08  1.14e-06   511s
  18   6.94338812e+03  6.94339604e+03  3.77e-09 3.45e-08  2.29e-07   535s
  19   6.94339204e+03  6.94339273e+03  1.84e-10 2.61e-08  1.86e-08   559s
  20   6.94339232e+03  6.94339237e+03  9.47e-12 1.43e-08  1.14e-09   587s

Barrier solved model in 20 iterations and 586.59 seconds
Optimal objective 6.94339232e+03

Optimization finished!
