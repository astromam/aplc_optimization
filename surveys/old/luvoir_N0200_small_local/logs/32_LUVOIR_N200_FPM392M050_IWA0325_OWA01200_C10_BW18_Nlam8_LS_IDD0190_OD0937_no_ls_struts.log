Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.92},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3.25,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0190_OD0937_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6720 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13440 rows, 13749 columns and 184786558 nonzeros
Coefficient statistics:
  Matrix range     [2e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6720 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6720 rows and 0 columns
Presolve time: 58.23s
Presolved: 6720 rows, 20469 columns, 92399990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.258e+07
 Factor NZ  : 2.258e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.012e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53884989e+06  3.07762049e+04  2.89e+01 1.82e-12  9.16e+02   100s
   1   9.77479232e+03  3.07221461e+04  2.87e-02 3.22e-10  1.53e+00   123s
   2   7.12486445e+03  1.60424893e+04  7.06e-03 2.93e-09  3.90e-01   146s
   3   6.90455289e+03  8.94483207e+03  1.86e-03 4.65e-09  7.84e-02   169s
   4   6.85706215e+03  7.70759883e+03  8.84e-04 6.45e-09  3.12e-02   192s
   5   6.88404590e+03  7.24633659e+03  4.13e-04 7.35e-09  1.30e-02   216s
   6   6.90756364e+03  7.10623535e+03  1.85e-04 9.78e-09  6.60e-03   240s
   7   6.91556389e+03  7.05644456e+03  1.33e-04 8.15e-09  4.67e-03   262s
   8   6.92633981e+03  7.01599805e+03  7.74e-05 8.16e-09  2.89e-03   286s
   9   6.93573799e+03  6.98197813e+03  3.26e-05 8.93e-09  1.42e-03   310s
  10   6.94058438e+03  6.96304174e+03  1.73e-05 2.60e-08  7.02e-04   334s
  11   6.94354095e+03  6.95629241e+03  9.69e-06 1.57e-08  3.97e-04   357s
  12   6.94675773e+03  6.94925837e+03  2.00e-06 9.96e-09  7.87e-05   382s
  13   6.94739286e+03  6.94844475e+03  9.52e-07 1.17e-08  3.41e-05   405s
  14   6.94795005e+03  6.94807367e+03  8.57e-08 1.32e-08  3.77e-06   430s
  15   6.94802368e+03  6.94803461e+03  2.36e-09 1.41e-08  2.88e-07   455s
  16   6.94802819e+03  6.94803006e+03  3.64e-10 1.09e-08  4.90e-08   481s
  17   6.94802895e+03  6.94802932e+03  7.28e-11 1.19e-08  9.71e-09   504s
  18   6.94802915e+03  6.94802917e+03  3.98e-12 1.05e-08  5.93e-10   528s

Barrier solved model in 18 iterations and 528.40 seconds
Optimal objective 6.94802915e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13440 rows, 13749 columns and 184786558 nonzeros
Coefficient statistics:
  Matrix range     [2e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6720 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6720 rows and 0 columns
Presolve time: 57.91s
Presolved: 6720 rows, 20469 columns, 92399990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.258e+07
 Factor NZ  : 2.258e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.012e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53884989e+06  3.04012530e+04  2.89e+01 1.82e-12  9.16e+02   100s
   1   9.88150224e+03  3.03470009e+04  2.94e-02 3.49e-10  1.54e+00   123s
   2   7.34670488e+03  1.58602453e+04  8.91e-03 2.36e-09  4.30e-01   146s
   3   6.97820887e+03  8.96006825e+03  2.42e-03 2.78e-08  8.98e-02   169s
   4   6.85914703e+03  7.58022281e+03  1.13e-03 9.81e-09  3.28e-02   192s
   5   6.84824419e+03  7.22514554e+03  5.38e-04 2.26e-08  1.55e-02   215s
   6   6.85302709e+03  7.11969460e+03  4.13e-04 2.84e-08  1.11e-02   239s
   7   6.85664597e+03  7.04061056e+03  3.37e-04 4.73e-08  8.10e-03   262s
   8   6.85763406e+03  6.99350480e+03  2.79e-04 1.91e-08  6.24e-03   285s
   9   6.86063385e+03  6.94991944e+03  2.28e-04 1.34e-08  4.50e-03   308s
  10   6.86126940e+03  6.93224889e+03  1.82e-04 1.49e-08  3.57e-03   331s
  11   6.86579991e+03  6.90248301e+03  1.42e-04 1.05e-08  2.30e-03   354s
  12   6.86761313e+03  6.89066376e+03  1.08e-04 1.00e-08  1.62e-03   377s
  13   6.86913153e+03  6.88309831e+03  8.28e-05 2.75e-08  1.15e-03   401s
  14   6.86974376e+03  6.87757102e+03  5.79e-05 5.45e-08  7.55e-04   424s
  15   6.86983924e+03  6.87448719e+03  4.10e-05 1.23e-08  5.13e-04   447s
  16   6.86967354e+03  6.87159888e+03  2.79e-05 1.48e-08  3.19e-04   471s
  17   6.86921479e+03  6.86998601e+03  1.91e-05 1.22e-08  2.05e-04   494s
  18   6.86859161e+03  6.86872650e+03  1.07e-05 1.31e-08  1.07e-04   518s
  19   6.86809152e+03  6.86804699e+03  5.00e-06 5.26e-08  4.78e-05   543s
  20   6.86786225e+03  6.86782231e+03  2.17e-06 3.42e-08  2.03e-05   567s
  21   6.86777201e+03  6.86775115e+03  9.42e-07 4.82e-08  8.69e-06   590s
  22   6.86771470e+03  6.86772160e+03  1.39e-07 1.57e-07  1.53e-06   616s
  23   6.86771208e+03  6.86771400e+03  3.43e-08 7.94e-08  3.82e-07   640s
  24   6.86771172e+03  6.86771255e+03  2.13e-09 3.17e-08  4.11e-08   664s
  25   6.86771182e+03  6.86771192e+03  4.86e-11 2.95e-08  2.79e-09   691s
  26   6.86771185e+03  6.86771186e+03  5.32e-12 1.61e-08  2.36e-10   715s

Barrier solved model in 26 iterations and 714.72 seconds
Optimal objective 6.86771185e+03

Optimization finished!
