Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.82},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0197_OD0974_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6768 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13536 rows, 13749 columns and 186106464 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [2e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 51s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 59s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 59.84s
Presolved: 6768 rows, 20517 columns, 93059992 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.99405437e+06  3.24340671e+04  2.10e+01 0.00e+00  9.24e+02   104s
   1   1.60178896e+04  3.23731259e+04  4.47e-02 1.09e-11  2.62e+00   127s
   2   7.23970932e+03  1.78784376e+04  4.68e-03 2.46e-09  4.28e-01   150s
   3   7.22258038e+03  1.00426086e+04  2.03e-03 2.85e-09  1.17e-01   173s
   4   7.17678166e+03  8.21005115e+03  1.09e-03 7.36e-09  4.60e-02   197s
   5   7.14401561e+03  7.89810144e+03  8.07e-04 4.32e-09  3.29e-02   221s
   6   7.11246871e+03  7.46512946e+03  5.26e-04 6.59e-09  1.73e-02   246s
   7   7.09890993e+03  7.36548750e+03  3.83e-04 7.86e-09  1.29e-02   271s
   8   7.09073968e+03  7.29884211e+03  2.85e-04 6.80e-09  9.88e-03   295s
   9   7.08232383e+03  7.22498431e+03  2.38e-04 8.73e-09  7.62e-03   320s
  10   7.07455679e+03  7.18980249e+03  1.99e-04 1.01e-08  6.34e-03   344s
  11   7.06390542e+03  7.13581543e+03  1.53e-04 1.26e-08  4.59e-03   370s
  12   7.05698934e+03  7.11316253e+03  1.27e-04 1.50e-08  3.78e-03   394s
  13   7.04836701e+03  7.07988697e+03  9.28e-05 1.47e-08  2.59e-03   419s
  14   7.04484992e+03  7.06813886e+03  8.15e-05 1.38e-08  2.20e-03   442s
  15   7.04124743e+03  7.06051768e+03  7.05e-05 1.52e-08  1.89e-03   466s
  16   7.03743092e+03  7.04734135e+03  5.70e-05 2.17e-08  1.41e-03   491s
  17   7.03254931e+03  7.03749184e+03  4.15e-05 1.50e-08  9.87e-04   515s
  18   7.03108152e+03  7.03135276e+03  3.70e-05 1.47e-08  7.87e-04   540s
  19   7.02875277e+03  7.02680085e+03  2.85e-05 1.45e-08  5.61e-04   566s
  20   7.02840997e+03  7.02574351e+03  2.76e-05 2.02e-08  5.26e-04   591s
  21   7.02577991e+03  7.02396941e+03  1.94e-05 1.54e-08  3.74e-04   616s
  22   7.02237437e+03  7.02011077e+03  1.11e-05 1.69e-07  1.87e-04   644s
  23   7.02146792e+03  7.01893152e+03  8.90e-06 5.91e-08  1.33e-04   668s
  24   7.01960775e+03  7.01796780e+03  4.74e-06 1.02e-07  6.39e-05   693s
  25   7.01896919e+03  7.01774572e+03  3.27e-06 5.96e-08  4.21e-05   717s
  26   7.01850137e+03  7.01761692e+03  2.21e-06 2.40e-07  2.71e-05   741s
  27   7.01815606e+03  7.01756975e+03  1.46e-06 1.92e-07  1.81e-05   765s
  28   7.01790749e+03  7.01749551e+03  9.61e-07 2.20e-07  1.12e-05   789s
  29   7.01780547e+03  7.01746608e+03  7.59e-07 2.07e-07  8.52e-06   812s
  30   7.01744143e+03  7.01744417e+03  3.35e-08 4.76e-07  8.08e-07   838s
  31   7.01743259e+03  7.01743416e+03  1.05e-08 2.02e-07  2.71e-07   864s
  32   7.01742881e+03  7.01742910e+03  2.32e-10 3.02e-07  1.22e-08   889s
  33   7.01742883e+03  7.01742891e+03  2.18e-11 7.45e-08  2.75e-09   913s
  34   7.01742883e+03  7.01742883e+03  2.30e-12 6.01e-08  1.20e-10   938s

Barrier solved model in 34 iterations and 938.50 seconds
Optimal objective 7.01742883e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13536 rows, 13749 columns and 186106464 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [2e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [6e-06, 6e-06]
Presolve removed 0 rows and 0 columns (presolve time = 12s) ...
Presolve removed 0 rows and 0 columns (presolve time = 18s) ...
Presolve removed 0 rows and 0 columns (presolve time = 30s) ...
Presolve removed 0 rows and 0 columns (presolve time = 52s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 59s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 59.74s
Presolved: 6768 rows, 20517 columns, 93059992 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.99405437e+06  3.19940017e+04  2.10e+01 0.00e+00  9.24e+02   104s
   1   1.60193587e+04  3.19328358e+04  4.47e-02 1.09e-11  2.61e+00   129s
   2   7.34212453e+03  1.74695127e+04  5.17e-03 1.93e-09  4.36e-01   154s
   3   7.25437497e+03  9.96667496e+03  2.47e-03 3.21e-09  1.30e-01   178s
   4   7.15249797e+03  8.19422153e+03  1.30e-03 5.53e-09  5.42e-02   202s
   5   7.14232149e+03  7.63041373e+03  9.29e-04 1.47e-08  3.19e-02   227s
   6   7.10749750e+03  7.37053603e+03  6.98e-04 6.63e-07  2.24e-02   251s
   7   7.08336917e+03  7.29855013e+03  5.99e-04 1.37e-08  1.94e-02   274s
   8   7.06209640e+03  7.20604108e+03  5.34e-04 1.74e-08  1.69e-02   298s
   9   7.04269300e+03  7.12851182e+03  4.83e-04 2.82e-08  1.50e-02   322s
  10   7.01700894e+03  7.03452805e+03  4.22e-04 2.14e-06  1.29e-02   347s
  11   6.99685206e+03  6.94036996e+03  3.86e-04 6.85e-06  1.14e-02   373s
  12   6.96953901e+03  6.86463583e+03  3.45e-04 1.07e-05  1.03e-02   398s
  13   6.94345857e+03  6.78609557e+03  3.18e-04 8.47e-06  9.39e-03   423s
  14   6.91922551e+03  6.69931358e+03  2.99e-04 5.30e-06  8.57e-03   448s
  15   6.88939784e+03  6.63870377e+03  2.80e-04 3.26e-06  8.01e-03   472s
  16   6.83343588e+03  6.58983397e+03  2.49e-04 3.59e-07  7.36e-03   496s
  17   6.79861956e+03  6.50728705e+03  2.32e-04 2.18e-05  6.36e-03   521s
  18   6.75121849e+03  6.44735400e+03  2.09e-04 1.56e-07  5.38e-03   546s
  19   6.70339776e+03  6.41759758e+03  1.87e-04 4.68e-07  4.82e-03   570s
  20   6.69925643e+03  6.40956843e+03  1.85e-04 4.28e-07  4.70e-03   594s
  21   6.67097930e+03  6.37864317e+03  1.73e-04 9.03e-07  4.16e-03   618s
  22   6.61117691e+03  6.35626944e+03  1.48e-04 1.17e-06  3.68e-03   643s
  23   6.57530484e+03  6.33233067e+03  1.33e-04 1.09e-06  3.20e-03   668s
  24   6.55008658e+03  6.32371305e+03  1.22e-04 4.92e-07  2.96e-03   693s
  25   6.50852553e+03  6.30522059e+03  1.05e-04 1.27e-06  2.49e-03   718s
  26   6.48042009e+03  6.28843519e+03  9.45e-05 9.01e-07  2.10e-03   744s
  27   6.45130160e+03  6.27920119e+03  8.30e-05 5.92e-07  1.82e-03   771s
  28   6.43856710e+03  6.27245376e+03  7.81e-05 9.36e-07  1.65e-03   795s
  29   6.41233382e+03  6.26380008e+03  6.82e-05 1.25e-06  1.41e-03   819s
  30   6.37548957e+03  6.25889421e+03  5.43e-05 2.11e-06  1.19e-03   845s
  31   6.35501030e+03  6.25156566e+03  4.68e-05 2.19e-06  9.84e-04   869s
  32   6.34090137e+03  6.24856774e+03  4.16e-05 1.83e-06  8.78e-04   892s
  33   6.32467633e+03  6.24427809e+03  3.56e-05 2.70e-06  7.41e-04   917s
  34   6.31322862e+03  6.24111543e+03  3.14e-05 3.57e-06  6.33e-04   942s
  35   6.30180392e+03  6.23748024e+03  2.71e-05 3.72e-06  5.05e-04   967s
  36   6.29299184e+03  6.23606142e+03  2.39e-05 3.90e-06  4.40e-04   991s
  37   6.28396714e+03  6.23280619e+03  2.05e-05 3.12e-06  3.27e-04  1016s
  38   6.27191606e+03  6.23014224e+03  1.61e-05 8.64e-06  2.19e-04  1041s
  39   6.26251599e+03  6.22941899e+03  1.26e-05 1.47e-06  1.67e-04  1066s
  40   6.25149332e+03  6.22876517e+03  8.73e-06 1.54e-05  1.20e-04  1091s
  41   6.24538813e+03  6.22819836e+03  6.52e-06 3.78e-05  8.60e-05  1116s
  42   6.23901139e+03  6.22759108e+03  4.28e-06 3.42e-06  5.40e-05  1142s
  43   6.23558738e+03  6.22724749e+03  3.08e-06 2.48e-06  3.61e-05  1166s
  44   6.23067783e+03  6.22702930e+03  1.36e-06 4.37e-05  1.71e-05  1192s
  45   6.22918328e+03  6.22689021e+03  8.37e-07 3.79e-06  9.24e-06  1217s
  46   6.22834914e+03  6.22685229e+03  5.45e-07 8.59e-07  5.91e-06  1242s
  47   6.22707835e+03  6.22680746e+03  9.95e-08 7.16e-05  1.15e-06  1269s
  48   6.22682586e+03  6.22679956e+03  1.01e-08 1.26e-05  1.44e-07  1297s
  49   6.22679769e+03  6.22679805e+03  9.19e-13 2.81e-07  8.65e-09  1327s
  50   6.22679770e+03  6.22679782e+03  9.04e-12 1.56e-07  1.56e-09  1352s
  51   6.22679762e+03  6.22679776e+03  2.63e-11 1.51e-07  6.94e-11  1377s

Barrier solved model in 51 iterations and 1377.16 seconds
Optimal objective 6.22679762e+03

Optimization finished!
