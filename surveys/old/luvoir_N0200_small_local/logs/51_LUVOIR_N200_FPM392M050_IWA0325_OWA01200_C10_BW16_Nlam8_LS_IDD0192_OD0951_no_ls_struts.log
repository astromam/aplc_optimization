Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.92},
 'image': {'bandwidth': 0.16,
           'contrast': 10,
           'iwa': 3.25,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0192_OD0951_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6720 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13440 rows, 13749 columns and 184786552 nonzeros
Coefficient statistics:
  Matrix range     [6e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6720 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6720 rows and 0 columns
Presolve time: 58.27s
Presolved: 6720 rows, 20469 columns, 92399994 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.258e+07
 Factor NZ  : 2.258e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.012e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69681764e+06  3.16890556e+04  2.60e+01 0.00e+00  9.23e+02   101s
   1   1.39261112e+04  3.16325421e+04  4.70e-02 1.09e-11  2.31e+00   123s
   2   7.50645171e+03  1.66061703e+04  7.63e-03 1.63e-09  4.35e-01   146s
   3   7.18060528e+03  9.77998775e+03  2.44e-03 4.50e-09  1.12e-01   170s
   4   7.14353296e+03  8.17505383e+03  1.31e-03 9.07e-09  4.51e-02   193s
   5   7.10879594e+03  7.88018575e+03  9.35e-04 1.50e-08  3.19e-02   215s
   6   7.08742694e+03  7.49617279e+03  6.10e-04 2.27e-08  1.74e-02   239s
   7   7.07270882e+03  7.34562736e+03  3.54e-04 2.34e-08  1.07e-02   261s
   8   7.06914124e+03  7.25891396e+03  2.47e-04 2.21e-08  7.35e-03   285s
   9   7.06879761e+03  7.18068870e+03  1.55e-04 2.12e-08  4.37e-03   309s
  10   7.06957306e+03  7.15273330e+03  1.19e-04 1.07e-08  3.26e-03   332s
  11   7.07036600e+03  7.12896425e+03  9.60e-05 1.84e-08  2.41e-03   355s
  12   7.07315291e+03  7.10373170e+03  7.11e-05 1.26e-08  1.46e-03   379s
  13   7.07525129e+03  7.09676291e+03  5.51e-05 1.55e-08  1.08e-03   402s
  14   7.07654560e+03  7.08883947e+03  4.11e-05 4.21e-08  7.11e-04   425s
  15   7.07686704e+03  7.08609571e+03  3.48e-05 2.91e-08  5.72e-04   447s
  16   7.07789850e+03  7.08179501e+03  1.91e-05 1.20e-08  2.85e-04   473s
  17   7.07844901e+03  7.07980782e+03  1.09e-05 1.08e-08  1.41e-04   497s
  18   7.07867588e+03  7.07903453e+03  2.37e-06 2.54e-08  3.22e-05   523s
  19   7.07880481e+03  7.07890365e+03  7.26e-09 4.00e-08  2.49e-06   549s
  20   7.07882513e+03  7.07887545e+03  3.28e-09 2.05e-08  1.26e-06   572s
  21   7.07884148e+03  7.07884682e+03  1.79e-10 1.49e-08  1.32e-07   596s
  22   7.07884239e+03  7.07884394e+03  4.56e-11 1.27e-08  3.85e-08   619s
  23   7.07884272e+03  7.07884281e+03  2.23e-12 1.55e-08  2.23e-09   644s
  24   7.07884276e+03  7.07884276e+03  5.10e-12 1.21e-08  8.45e-11   669s

Barrier solved model in 24 iterations and 668.64 seconds
Optimal objective 7.07884276e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13440 rows, 13749 columns and 184786552 nonzeros
Coefficient statistics:
  Matrix range     [6e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6720 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6720 rows and 0 columns
Presolve time: 58.07s
Presolved: 6720 rows, 20469 columns, 92399994 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.258e+07
 Factor NZ  : 2.258e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.012e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69681764e+06  3.13007030e+04  2.60e+01 0.00e+00  9.23e+02   101s
   1   1.39269659e+04  3.12439966e+04  4.70e-02 1.09e-11  2.30e+00   123s
   2   7.66187329e+03  1.62387105e+04  8.60e-03 1.58e-09  4.53e-01   146s
   3   7.12763341e+03  9.62866346e+03  2.26e-03 4.34e-09  1.09e-01   169s
   4   6.98931721e+03  7.76809750e+03  9.31e-04 8.38e-09  3.35e-02   192s
   5   6.98064839e+03  7.37401338e+03  5.70e-04 1.23e-08  1.72e-02   216s
   6   6.98236333e+03  7.24011073e+03  3.68e-04 1.04e-08  1.09e-02   239s
   7   6.98271382e+03  7.16277897e+03  2.45e-04 1.34e-08  7.31e-03   262s
   8   6.98433216e+03  7.10240432e+03  1.66e-04 1.18e-08  4.81e-03   285s
   9   6.98654343e+03  7.05733900e+03  1.11e-04 2.34e-08  2.99e-03   309s
  10   6.98853086e+03  7.04238084e+03  8.40e-05 1.87e-08  2.27e-03   332s
  11   6.98997930e+03  7.03057985e+03  6.25e-05 1.38e-08  1.69e-03   355s
  12   6.99209346e+03  7.01258030e+03  4.54e-05 1.15e-08  1.00e-03   379s
  13   6.99423112e+03  7.00497260e+03  2.83e-05 1.38e-08  5.76e-04   403s
  14   6.99505353e+03  7.00004096e+03  1.73e-05 1.29e-08  3.12e-04   426s
  15   6.99549493e+03  6.99763218e+03  1.25e-05 2.04e-08  1.90e-04   449s
  16   6.99565243e+03  6.99644445e+03  4.49e-06 2.42e-08  6.88e-05   473s
  17   6.99581548e+03  6.99595464e+03  2.76e-07 1.41e-08  6.44e-06   499s
  18   6.99585267e+03  6.99591600e+03  9.41e-08 1.85e-08  2.58e-06   522s
  19   6.99587008e+03  6.99588236e+03  1.71e-08 1.36e-08  4.88e-07   546s
  20   6.99587437e+03  6.99587656e+03  1.21e-09 1.90e-08  6.68e-08   570s
  21   6.99587493e+03  6.99587520e+03  8.70e-11 1.58e-08  7.68e-09   594s
  22   6.99587497e+03  6.99587499e+03  6.24e-12 1.98e-08  5.91e-10   618s

Barrier solved model in 22 iterations and 617.61 seconds
Optimal objective 6.99587497e+03

Optimization finished!
