Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.82},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0192_OD0951_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6768 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 58.58s
Presolved: 6768 rows, 20517 columns, 93059992 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69665559e+06  3.17252375e+04  2.63e+01 0.00e+00  9.24e+02   102s
   1   1.32417820e+04  3.16675593e+04  4.43e-02 1.09e-11  2.19e+00   125s
   2   7.00685518e+03  1.60373861e+04  5.05e-03 1.90e-09  3.56e-01   148s
   3   6.98327551e+03  9.68984989e+03  1.89e-03 3.89e-09  1.00e-01   172s
   4   7.01107677e+03  8.56525076e+03  1.09e-03 4.74e-09  5.43e-02   195s
   5   6.99438764e+03  7.53761170e+03  4.52e-04 1.46e-08  1.86e-02   219s
   6   7.00986433e+03  7.34402774e+03  3.24e-04 1.26e-08  1.18e-02   243s
   7   7.02274731e+03  7.26101059e+03  2.32e-04 9.30e-09  8.33e-03   266s
   8   7.03065753e+03  7.21249557e+03  1.83e-04 1.20e-08  6.38e-03   289s
   9   7.04388379e+03  7.15329680e+03  1.27e-04 1.25e-08  3.99e-03   313s
  10   7.05075128e+03  7.13249586e+03  9.26e-05 1.08e-08  2.95e-03   336s
  11   7.05655216e+03  7.10636933e+03  6.43e-05 8.88e-09  1.87e-03   360s
  12   7.06045976e+03  7.09355098e+03  4.43e-05 1.06e-08  1.26e-03   385s
  13   7.06430010e+03  7.08094636e+03  2.47e-05 1.20e-08  6.55e-04   409s
  14   7.06562712e+03  7.07710422e+03  1.88e-05 1.08e-08  4.69e-04   432s
  15   7.06708216e+03  7.07440553e+03  1.29e-05 9.33e-09  3.08e-04   455s
  16   7.06761776e+03  7.07326361e+03  1.06e-05 8.77e-09  2.44e-04   479s
  17   7.06849230e+03  7.07185961e+03  7.38e-06 1.12e-08  1.56e-04   502s
  18   7.06962249e+03  7.07046770e+03  1.01e-06 1.35e-08  3.08e-05   529s
  19   7.06993914e+03  7.07003886e+03  7.47e-08 1.30e-08  3.18e-06   554s
  20   7.06997401e+03  7.06999188e+03  1.48e-08 1.24e-08  5.84e-07   578s
  21   7.06998415e+03  7.06998527e+03  1.47e-10 1.35e-08  2.88e-08   603s
  22   7.06998448e+03  7.06998456e+03  8.64e-12 1.23e-08  2.12e-09   628s
  23   7.06998451e+03  7.06998451e+03  1.45e-11 1.00e-08  6.51e-11   654s

Barrier solved model in 23 iterations and 653.55 seconds
Optimal objective 7.06998451e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 58.36s
Presolved: 6768 rows, 20517 columns, 93059992 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69665559e+06  3.13329616e+04  2.63e+01 0.00e+00  9.24e+02   101s
   1   1.32405317e+04  3.12750876e+04  4.43e-02 1.00e-11  2.18e+00   124s
   2   7.07994863e+03  1.56746059e+04  5.56e-03 1.98e-09  3.62e-01   147s
   3   7.06245439e+03  9.47930775e+03  2.41e-03 4.26e-09  1.06e-01   171s
   4   7.02810497e+03  8.46068187e+03  1.33e-03 7.00e-09  5.73e-02   194s
   5   6.95337994e+03  7.53252950e+03  5.87e-04 1.54e-08  2.25e-02   218s
   6   6.95743092e+03  7.33546305e+03  4.05e-04 1.04e-08  1.46e-02   242s
   7   6.95811006e+03  7.23097843e+03  2.96e-04 9.21e-09  1.04e-02   265s
   8   6.96245416e+03  7.15067570e+03  2.23e-04 1.07e-08  7.31e-03   289s
   9   6.96430485e+03  7.11575787e+03  1.82e-04 1.01e-08  5.87e-03   312s
  10   6.96747298e+03  7.07239117e+03  1.30e-04 1.26e-08  4.08e-03   336s
  11   6.97003989e+03  7.03123160e+03  1.01e-04 1.13e-08  2.66e-03   360s
  12   6.97131077e+03  7.02441015e+03  8.35e-05 8.80e-09  2.26e-03   383s
  13   6.97364042e+03  7.00659140e+03  4.97e-05 1.28e-08  1.37e-03   407s
  14   6.97521749e+03  6.99776633e+03  3.56e-05 1.20e-08  9.57e-04   431s
  15   6.97652571e+03  6.99068885e+03  2.27e-05 1.79e-08  6.06e-04   455s
  16   6.97763929e+03  6.98714705e+03  1.35e-05 1.20e-08  3.87e-04   479s
  17   6.97799146e+03  6.98302906e+03  1.05e-05 1.68e-08  2.44e-04   502s
  18   6.97854630e+03  6.98076981e+03  5.72e-06 3.84e-08  1.20e-04   527s
  19   6.97894016e+03  6.97991863e+03  2.92e-06 3.82e-08  5.75e-05   550s
  20   6.97907694e+03  6.97962551e+03  1.93e-06 3.98e-08  3.56e-05   573s
  21   6.97922485e+03  6.97944156e+03  9.81e-07 5.94e-08  1.66e-05   597s
  22   6.97929435e+03  6.97940607e+03  4.59e-07 3.80e-08  8.02e-06   621s
  23   6.97936057e+03  6.97937944e+03  4.18e-09 1.81e-08  5.08e-07   647s
  24   6.97936635e+03  6.97936711e+03  7.35e-11 1.95e-08  1.94e-08   675s
  25   6.97936655e+03  6.97936662e+03  9.08e-12 2.42e-08  1.48e-09   698s

Barrier solved model in 25 iterations and 698.49 seconds
Optimal objective 6.97936655e+03

Optimization finished!
