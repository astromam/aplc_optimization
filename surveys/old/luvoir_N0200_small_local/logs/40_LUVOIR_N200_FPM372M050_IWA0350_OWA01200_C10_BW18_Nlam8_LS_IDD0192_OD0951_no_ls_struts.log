Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.72},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3.5,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0192_OD0951_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6592 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13184 rows, 13749 columns and 181266812 nonzeros
Coefficient statistics:
  Matrix range     [2e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 57.00s
Presolved: 6592 rows, 20341 columns, 90639990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69928607e+06  3.10798745e+04  2.87e+01 1.82e-12  9.21e+02    98s
   1   1.06584352e+04  3.10240597e+04  3.28e-02 4.40e-10  1.68e+00   120s
   2   6.81929681e+03  1.33452520e+04  3.23e-03 2.67e-09  2.32e-01   142s
   3   7.05804535e+03  8.89046149e+03  1.48e-03 3.01e-09  6.63e-02   164s
   4   7.12059796e+03  8.14798430e+03  1.01e-03 3.75e-09  3.76e-02   186s
   5   7.13541825e+03  7.73541213e+03  6.08e-04 6.38e-09  2.16e-02   209s
   6   7.13934569e+03  7.57470449e+03  4.60e-04 5.04e-09  1.57e-02   231s
   7   7.14020500e+03  7.50963432e+03  3.49e-04 6.54e-09  1.28e-02   253s
   8   7.14102059e+03  7.39956498e+03  2.54e-04 6.24e-09  8.98e-03   275s
   9   7.14157012e+03  7.33475295e+03  2.01e-04 9.46e-09  6.77e-03   297s
  10   7.14377447e+03  7.28720453e+03  1.56e-04 8.77e-09  5.07e-03   319s
  11   7.14669314e+03  7.24059486e+03  1.23e-04 9.71e-09  3.51e-03   341s
  12   7.14930303e+03  7.20968275e+03  9.30e-05 1.07e-08  2.38e-03   364s
  13   7.15188415e+03  7.19985021e+03  6.90e-05 1.11e-08  1.84e-03   386s
  14   7.15316894e+03  7.18637904e+03  5.58e-05 1.25e-08  1.35e-03   408s
  15   7.15508803e+03  7.17858970e+03  4.30e-05 1.16e-08  9.84e-04   430s
  16   7.15636065e+03  7.17262900e+03  3.46e-05 1.30e-08  7.26e-04   453s
  17   7.15745077e+03  7.16795008e+03  2.69e-05 1.22e-08  5.10e-04   475s
  18   7.15882950e+03  7.16261993e+03  1.52e-05 1.24e-08  2.35e-04   499s
  19   7.15950681e+03  7.16189745e+03  1.09e-05 1.01e-08  1.60e-04   521s
  20   7.15979940e+03  7.16127459e+03  6.97e-06 1.29e-08  1.01e-04   543s
  21   7.16009608e+03  7.16093687e+03  3.49e-06 9.83e-09  5.32e-05   566s
  22   7.16030375e+03  7.16046807e+03  4.72e-07 4.87e-08  8.44e-06   591s
  23   7.16037434e+03  7.16039089e+03  1.54e-08 2.50e-08  5.50e-07   616s
  24   7.16037994e+03  7.16038381e+03  3.13e-09 2.56e-08  1.25e-07   640s
  25   7.16038154e+03  7.16038208e+03  3.63e-10 1.63e-08  1.64e-08   664s
  26   7.16038184e+03  7.16038187e+03  1.51e-11 1.25e-08  9.59e-10   687s

Barrier solved model in 26 iterations and 687.27 seconds
Optimal objective 7.16038184e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13184 rows, 13749 columns and 181266812 nonzeros
Coefficient statistics:
  Matrix range     [2e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 56.70s
Presolved: 6592 rows, 20341 columns, 90639990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69928607e+06  3.07094628e+04  2.87e+01 1.82e-12  9.21e+02    98s
   1   1.06586943e+04  3.06534600e+04  3.28e-02 7.09e-10  1.67e+00   120s
   2   6.77984128e+03  1.30848211e+04  3.09e-03 2.92e-09  2.25e-01   142s
   3   7.00804769e+03  8.72196142e+03  1.91e-03 3.61e-09  7.17e-02   164s
   4   7.06002925e+03  7.80822022e+03  1.20e-03 9.43e-09  3.49e-02   186s
   5   7.07491846e+03  7.50974981e+03  8.29e-04 1.19e-08  2.18e-02   209s
   6   7.07414880e+03  7.35981519e+03  6.11e-04 1.47e-08  1.52e-02   231s
   7   7.07633747e+03  7.25370367e+03  4.87e-04 1.57e-08  1.11e-02   254s
   8   7.07045923e+03  7.20278090e+03  4.27e-04 1.70e-08  9.27e-03   276s
   9   7.06630770e+03  7.17062112e+03  3.78e-04 1.82e-08  7.98e-03   298s
  10   7.06230647e+03  7.14682648e+03  3.35e-04 1.91e-08  6.98e-03   319s
  11   7.05924407e+03  7.12124074e+03  3.01e-04 2.27e-08  6.04e-03   341s
  12   7.05657793e+03  7.08747759e+03  2.58e-04 2.50e-08  4.82e-03   364s
  13   7.05349908e+03  7.06894480e+03  2.31e-04 2.74e-08  4.19e-03   386s
  14   7.04908374e+03  7.05056355e+03  1.98e-04 3.98e-08  3.53e-03   408s
  15   7.04492144e+03  7.04315809e+03  1.77e-04 3.11e-08  3.17e-03   430s
  16   7.04343689e+03  7.03760874e+03  1.68e-04 3.67e-08  2.98e-03   451s
  17   7.04037229e+03  7.02576125e+03  1.49e-04 4.60e-08  2.56e-03   474s
  18   7.03761396e+03  7.01415731e+03  1.36e-04 8.54e-08  2.30e-03   497s
  19   7.03445589e+03  7.00153960e+03  1.26e-04 4.86e-08  2.07e-03   519s
  20   7.03023812e+03  6.99166904e+03  1.14e-04 6.69e-08  1.87e-03   543s
  21   7.02602219e+03  6.98555495e+03  1.05e-04 7.41e-08  1.74e-03   564s
  22   7.02284900e+03  6.97614310e+03  9.87e-05 6.24e-08  1.60e-03   587s
  23   7.01786114e+03  6.96959525e+03  9.06e-05 6.89e-08  1.47e-03   610s
  24   7.01117930e+03  6.96281748e+03  8.06e-05 7.38e-08  1.32e-03   633s
  25   7.00829014e+03  6.95513321e+03  7.70e-05 9.03e-08  1.25e-03   655s
  26   7.00202579e+03  6.94613505e+03  6.98e-05 1.41e-07  1.13e-03   678s
  27   6.99775231e+03  6.93982059e+03  6.56e-05 1.18e-07  1.06e-03   701s
  28   6.99343854e+03  6.93679375e+03  6.15e-05 1.49e-07  9.94e-04   723s
  29   6.99098231e+03  6.93376992e+03  5.95e-05 1.17e-07  9.57e-04   744s
  30   6.98567716e+03  6.92890272e+03  5.50e-05 2.68e-07  8.73e-04   767s
  31   6.98149666e+03  6.92482274e+03  5.15e-05 1.30e-07  8.04e-04   789s
  32   6.97749914e+03  6.92189577e+03  4.83e-05 1.27e-07  7.40e-04   811s
  33   6.97371535e+03  6.91978704e+03  4.54e-05 1.62e-07  6.90e-04   834s
  34   6.96928761e+03  6.91790620e+03  4.22e-05 1.64e-07  6.39e-04   857s
  35   6.96492953e+03  6.91614698e+03  3.89e-05 2.37e-07  5.80e-04   881s
  36   6.96136004e+03  6.91380633e+03  3.63e-05 2.50e-07  5.21e-04   904s
  37   6.95556235e+03  6.91222615e+03  3.22e-05 2.54e-07  4.61e-04   926s
  38   6.95048214e+03  6.91142084e+03  2.87e-05 1.90e-07  4.11e-04   949s
  39   6.94403008e+03  6.91014024e+03  2.45e-05 2.03e-07  3.50e-04   973s
  40   6.94168805e+03  6.90904351e+03  2.30e-05 2.05e-07  3.21e-04   995s
  41   6.93784910e+03  6.90868775e+03  2.05e-05 2.48e-07  2.88e-04  1018s
  42   6.93329182e+03  6.90752384e+03  1.75e-05 5.76e-07  2.34e-04  1043s
  43   6.92876056e+03  6.90632365e+03  1.46e-05 6.34e-07  1.78e-04  1067s
  44   6.92545152e+03  6.90577826e+03  1.26e-05 1.36e-07  1.47e-04  1090s
  45   6.92110348e+03  6.90508785e+03  9.88e-06 1.49e-07  1.05e-04  1114s
  46   6.91917855e+03  6.90500295e+03  8.75e-06 1.45e-07  9.36e-05  1137s
  47   6.91548321e+03  6.90469648e+03  6.52e-06 2.42e-07  6.60e-05  1160s
  48   6.91383410e+03  6.90453005e+03  5.55e-06 7.15e-07  5.37e-05  1184s
  49   6.91120111e+03  6.90436060e+03  4.02e-06 4.86e-07  3.71e-05  1207s
  50   6.91001834e+03  6.90432135e+03  3.35e-06 6.39e-07  3.09e-05  1229s
  51   6.90902507e+03  6.90424400e+03  2.76e-06 6.74e-07  2.35e-05  1253s
  52   6.90774506e+03  6.90422312e+03  2.03e-06 9.40e-07  1.72e-05  1275s
  53   6.90706257e+03  6.90418903e+03  1.63e-06 1.55e-06  1.32e-05  1298s
  54   6.90648277e+03  6.90418058e+03  1.30e-06 9.31e-07  1.01e-05  1322s
  55   6.90593806e+03  6.90416834e+03  9.88e-07 6.58e-07  7.28e-06  1347s
  56   6.90540065e+03  6.90416283e+03  6.87e-07 9.59e-07  4.92e-06  1370s
  57   6.90490551e+03  6.90415573e+03  4.14e-07 7.92e-07  2.90e-06  1395s
  58   6.90457393e+03  6.90415421e+03  2.33e-07 1.13e-06  1.65e-06  1418s
  59   6.90436007e+03  6.90415256e+03  1.15e-07 2.36e-06  8.17e-07  1441s
  60   6.90424984e+03  6.90415169e+03  5.43e-08 1.25e-06  3.83e-07  1465s
  61   6.90424516e+03  6.90415137e+03  5.12e-08 6.68e-07  3.54e-07  1487s
  62   6.90424184e+03  6.90415137e+03  5.11e-08 6.67e-07  3.53e-07  1510s
  63   6.90417305e+03  6.90415171e+03  1.37e-08 1.55e-06  1.50e-07  1533s
  64   6.90415382e+03  6.90415101e+03  1.36e-10 8.65e-06  4.11e-09  1559s
  65   6.90415151e+03  6.90415089e+03  7.49e-11 5.79e-07  4.97e-10  1582s

Barrier solved model in 65 iterations and 1581.63 seconds
Optimal objective 6.90415151e+03

Optimization finished!
