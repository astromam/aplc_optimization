Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.72},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0190_OD0937_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6768 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 58.58s
Presolved: 6768 rows, 20517 columns, 93059992 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53581541e+06  3.04279902e+04  3.18e+01 1.82e-12  9.05e+02   102s
   1   8.86135192e+03  3.03739107e+04  2.58e-02 3.49e-10  1.35e+00   125s
   2   6.89241798e+03  1.52321717e+04  6.52e-03 2.55e-09  3.43e-01   148s
   3   6.89728782e+03  1.27075991e+04  3.44e-03 3.91e-09  2.05e-01   172s
   4   6.91815241e+03  8.64419205e+03  1.77e-03 8.77e-09  6.57e-02   195s
   5   6.96093112e+03  8.01201509e+03  1.23e-03 1.12e-08  4.06e-02   219s
   6   6.97093496e+03  7.53572319e+03  6.41e-04 3.78e-08  2.12e-02   243s
   7   6.98361414e+03  7.25863210e+03  3.22e-04 1.64e-08  1.02e-02   266s
   8   6.99257431e+03  7.12982132e+03  1.37e-04 4.17e-08  4.75e-03   291s
   9   7.00246208e+03  7.08578382e+03  9.15e-05 7.45e-08  2.93e-03   315s
  10   7.00835048e+03  7.06335042e+03  6.88e-05 7.31e-08  2.00e-03   338s
  11   7.01565149e+03  7.04598768e+03  3.91e-05 8.20e-08  1.11e-03   362s
  12   7.01960214e+03  7.03908621e+03  2.61e-05 1.61e-07  7.17e-04   386s
  13   7.02214630e+03  7.03538404e+03  1.75e-05 1.84e-07  4.84e-04   409s
  14   7.02393553e+03  7.03214661e+03  1.23e-05 1.89e-07  3.13e-04   432s
  15   7.02560936e+03  7.03028168e+03  7.18e-06 3.42e-08  1.79e-04   455s
  16   7.02663838e+03  7.02927206e+03  4.30e-06 1.81e-08  1.03e-04   479s
  17   7.02766434e+03  7.02828536e+03  9.21e-07 2.98e-08  2.35e-05   504s
  18   7.02783202e+03  7.02815186e+03  5.00e-07 1.24e-08  1.23e-05   527s
  19   7.02798082e+03  7.02807468e+03  1.36e-07 1.48e-08  3.52e-06   551s
  20   7.02803433e+03  7.02804469e+03  1.03e-08 1.68e-07  3.46e-07   575s
  21   7.02804008e+03  7.02804115e+03  6.16e-10 1.48e-08  3.17e-08   598s
  22   7.02804046e+03  7.02804069e+03  6.51e-11 1.29e-08  6.22e-09   623s
  23   7.02804050e+03  7.02804052e+03  4.09e-12 1.59e-08  2.72e-10   647s

Barrier solved model in 23 iterations and 646.83 seconds
Optimal objective 7.02804050e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 58.36s
Presolved: 6768 rows, 20517 columns, 93059992 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53581541e+06  3.00643193e+04  3.18e+01 1.82e-12  9.05e+02   101s
   1   8.97297512e+03  3.00100553e+04  2.66e-02 3.78e-10  1.36e+00   124s
   2   7.04512008e+03  1.52731174e+04  8.05e-03 2.71e-09  3.78e-01   148s
   3   6.97416364e+03  1.05489049e+04  3.38e-03 5.83e-09  1.46e-01   171s
   4   7.02295292e+03  8.55136630e+03  2.19e-03 1.16e-08  7.06e-02   194s
   5   7.01407033e+03  7.87577119e+03  1.43e-03 1.68e-08  4.28e-02   218s
   6   6.98616062e+03  7.55268385e+03  1.04e-03 3.52e-08  3.04e-02   241s
   7   6.95812474e+03  7.33385878e+03  7.84e-04 3.18e-08  2.23e-02   264s
   8   6.92669254e+03  7.11728635e+03  5.76e-04 3.70e-08  1.54e-02   289s
   9   6.91051534e+03  7.02107633e+03  4.95e-04 5.55e-08  1.26e-02   313s
  10   6.89352744e+03  6.97570614e+03  4.37e-04 5.92e-08  1.12e-02   336s
  11   6.87380491e+03  6.90086863e+03  3.83e-04 7.70e-08  9.47e-03   360s
  12   6.85763594e+03  6.87531903e+03  3.49e-04 8.76e-08  8.76e-03   383s
  13   6.82979839e+03  6.83390553e+03  2.97e-04 7.85e-08  7.61e-03   407s
  14   6.80771833e+03  6.78195887e+03  2.59e-04 1.75e-07  6.28e-03   431s
  15   6.78951282e+03  6.74962309e+03  2.31e-04 1.97e-07  5.43e-03   455s
  16   6.77248447e+03  6.73218753e+03  2.06e-04 1.68e-07  4.85e-03   478s
  17   6.76071728e+03  6.70655197e+03  1.90e-04 1.28e-07  4.24e-03   501s
  18   6.74689238e+03  6.69716837e+03  1.71e-04 1.21e-07  3.87e-03   524s
  19   6.73421019e+03  6.68036498e+03  1.56e-04 1.67e-07  3.51e-03   548s
  20   6.71627303e+03  6.66084665e+03  1.34e-04 2.05e-07  2.94e-03   572s
  21   6.70890613e+03  6.65006537e+03  1.26e-04 1.21e-07  2.62e-03   595s
  22   6.68934347e+03  6.63708200e+03  1.02e-04 1.81e-07  2.06e-03   619s
  23   6.67376687e+03  6.62680321e+03  8.40e-05 1.34e-07  1.66e-03   643s
  24   6.66478531e+03  6.61502704e+03  7.39e-05 1.07e-06  1.31e-03   667s
  25   6.64659926e+03  6.60920581e+03  5.50e-05 5.89e-07  9.80e-04   691s
  26   6.63505144e+03  6.60261038e+03  4.28e-05 6.30e-07  6.94e-04   715s
  27   6.62671774e+03  6.59908736e+03  3.44e-05 1.84e-07  5.31e-04   738s
  28   6.61923165e+03  6.59656591e+03  2.67e-05 2.35e-07  3.87e-04   762s
  29   6.61545302e+03  6.59563301e+03  2.30e-05 3.37e-07  3.29e-04   785s
  30   6.60797941e+03  6.59425392e+03  1.57e-05 2.09e-07  2.21e-04   808s
  31   6.60435438e+03  6.59352137e+03  1.20e-05 3.03e-07  1.63e-04   832s
  32   6.60048811e+03  6.59239343e+03  8.22e-06 4.06e-07  9.56e-05   856s
  33   6.59865780e+03  6.59204948e+03  6.43e-06 1.25e-06  6.85e-05   879s
  34   6.59574891e+03  6.59180600e+03  3.80e-06 1.27e-06  3.97e-05   905s
  35   6.59454478e+03  6.59172801e+03  2.69e-06 5.51e-07  2.76e-05   929s
  36   6.59354421e+03  6.59169903e+03  1.78e-06 8.12e-07  1.89e-05   952s
  37   6.59235578e+03  6.59161817e+03  7.11e-07 1.02e-06  7.51e-06   978s
  38   6.59172990e+03  6.59157804e+03  1.45e-07 2.22e-06  1.49e-06  1005s
  39   6.59164954e+03  6.59157417e+03  7.08e-08 2.28e-06  7.07e-07  1031s
  40   6.59157238e+03  6.59157250e+03  4.32e-10 1.86e-06  1.69e-08  1056s
  41   6.59157214e+03  6.59157214e+03  2.18e-11 1.64e-06  7.60e-10  1082s

Barrier solved model in 41 iterations and 1081.84 seconds
Optimal objective 6.59157214e+03

Optimization finished!
