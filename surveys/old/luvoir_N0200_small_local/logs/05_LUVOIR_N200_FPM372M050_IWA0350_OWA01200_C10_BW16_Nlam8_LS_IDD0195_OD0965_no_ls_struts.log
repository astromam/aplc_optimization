Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.72},
 'image': {'bandwidth': 0.16,
           'contrast': 10,
           'iwa': 3.5,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0195_OD0965_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6592 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13184 rows, 13749 columns and 181266812 nonzeros
Coefficient statistics:
  Matrix range     [5e-13, 2e-04]
  Objective range  [1e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 57.10s
Presolved: 6592 rows, 20341 columns, 90639996 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.87719802e+06  3.18956703e+04  2.59e+01 0.00e+00  9.24e+02    98s
   1   1.46748819e+04  3.18369367e+04  4.93e-02 1.09e-11  2.40e+00   120s
   2   6.84988819e+03  1.69553679e+04  3.48e-03 2.96e-09  3.47e-01   142s
   3   7.02059245e+03  9.54436952e+03  1.34e-03 5.61e-09  8.63e-02   164s
   4   7.05034632e+03  7.80385635e+03  6.55e-04 6.05e-09  2.77e-02   186s
   5   7.08625526e+03  7.54287384e+03  3.69e-04 5.71e-09  1.62e-02   208s
   6   7.09603354e+03  7.41228012e+03  2.89e-04 8.35e-09  1.16e-02   230s
   7   7.10969878e+03  7.28185821e+03  2.12e-04 8.48e-09  7.05e-03   253s
   8   7.11576272e+03  7.23589713e+03  1.64e-04 1.04e-08  5.14e-03   275s
   9   7.12574433e+03  7.18692322e+03  9.95e-05 1.28e-08  2.86e-03   298s
  10   7.13071613e+03  7.16888850e+03  6.56e-05 1.31e-08  1.84e-03   320s
  11   7.13312263e+03  7.15865663e+03  4.85e-05 1.19e-08  1.30e-03   342s
  12   7.13501716e+03  7.15016095e+03  3.28e-05 1.30e-08  8.31e-04   365s
  13   7.13593722e+03  7.14502826e+03  2.47e-05 3.82e-08  5.70e-04   387s
  14   7.13700320e+03  7.14137806e+03  1.62e-05 5.36e-08  3.36e-04   410s
  15   7.13737890e+03  7.13954811e+03  7.69e-06 3.66e-08  1.62e-04   433s
  16   7.13747251e+03  7.13859727e+03  5.18e-06 3.57e-08  1.01e-04   455s
  17   7.13747233e+03  7.13780053e+03  8.26e-07 5.17e-08  1.98e-05   480s
  18   7.13754118e+03  7.13760820e+03  1.96e-07 5.08e-08  4.44e-06   503s
  19   7.13756062e+03  7.13758987e+03  7.71e-08 4.49e-08  1.82e-06   526s
  20   7.13757273e+03  7.13757544e+03  2.23e-09 1.75e-08  9.82e-08   549s
  21   7.13757393e+03  7.13757419e+03  1.12e-10 3.07e-08  8.04e-09   572s
  22   7.13757402e+03  7.13757403e+03  2.74e-12 3.07e-08  3.06e-10   596s

Barrier solved model in 22 iterations and 596.30 seconds
Optimal objective 7.13757402e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13184 rows, 13749 columns and 181266812 nonzeros
Coefficient statistics:
  Matrix range     [5e-13, 2e-04]
  Objective range  [1e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 16s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 56.94s
Presolved: 6592 rows, 20341 columns, 90639996 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.87719802e+06  3.14965944e+04  2.59e+01 0.00e+00  9.24e+02    98s
   1   1.46865104e+04  3.14376590e+04  4.94e-02 1.46e-11  2.40e+00   120s
   2   6.90868831e+03  1.65939430e+04  3.88e-03 2.57e-09  3.50e-01   142s
   3   7.02537655e+03  9.83943233e+03  1.82e-03 5.26e-09  1.06e-01   164s
   4   7.07614935e+03  8.16024294e+03  1.09e-03 9.98e-09  4.57e-02   187s
   5   7.07050644e+03  7.62846277e+03  6.84e-04 2.84e-08  2.66e-02   209s
   6   7.06118937e+03  7.43218569e+03  5.47e-04 3.00e-08  2.02e-02   231s
   7   7.04705400e+03  7.33294926e+03  4.53e-04 3.33e-08  1.69e-02   253s
   8   7.03712658e+03  7.21391808e+03  4.11e-04 4.84e-08  1.43e-02   275s
   9   7.02428192e+03  7.13992405e+03  3.76e-04 4.47e-08  1.28e-02   297s
  10   7.00846459e+03  7.08216142e+03  3.46e-04 5.82e-08  1.17e-02   319s
  11   7.00331401e+03  7.05926295e+03  3.37e-04 5.70e-08  1.14e-02   341s
  12   6.98581262e+03  6.99748000e+03  3.12e-04 6.31e-08  1.05e-02   363s
  13   6.97807203e+03  6.94619973e+03  3.04e-04 8.94e-08  9.86e-03   386s
  14   6.94242534e+03  6.85958905e+03  2.66e-04 1.04e-07  8.46e-03   408s
  15   6.91497227e+03  6.80144176e+03  2.43e-04 1.71e-07  7.45e-03   430s
  16   6.87864711e+03  6.74710449e+03  2.15e-04 1.42e-07  6.34e-03   452s
  17   6.84492356e+03  6.70845563e+03  1.92e-04 6.07e-06  5.55e-03   475s
  18   6.79959261e+03  6.66415774e+03  1.61e-04 1.23e-05  4.39e-03   498s
  19   6.75160303e+03  6.62934903e+03  1.29e-04 6.62e-06  3.33e-03   521s
  20   6.72410969e+03  6.60805258e+03  1.11e-04 1.06e-05  2.66e-03   543s
  21   6.70324233e+03  6.59320404e+03  9.72e-05 1.14e-05  2.17e-03   565s
  22   6.68225997e+03  6.58443394e+03  8.36e-05 1.76e-05  1.81e-03   587s
  23   6.66380881e+03  6.57822376e+03  7.17e-05 2.21e-05  1.53e-03   609s
  24   6.66209665e+03  6.57423202e+03  7.07e-05 2.16e-05  1.44e-03   631s
  25   6.65067942e+03  6.57112782e+03  6.32e-05 1.74e-05  1.27e-03   653s
  26   6.63751177e+03  6.56818359e+03  5.50e-05 1.82e-05  1.11e-03   675s
  27   6.62418007e+03  6.56283595e+03  4.62e-05 1.61e-05  8.70e-04   697s
  28   6.60413828e+03  6.56003670e+03  3.37e-05 1.61e-05  6.58e-04   720s
  29   6.59552650e+03  6.55751377e+03  2.85e-05 1.23e-05  5.44e-04   742s
  30   6.58620586e+03  6.55422058e+03  2.28e-05 1.55e-07  3.98e-04   764s
  31   6.58134800e+03  6.55266011e+03  1.98e-05 1.23e-07  3.25e-04   787s
  32   6.57638682e+03  6.55176649e+03  1.66e-05 1.38e-07  2.63e-04   809s
  33   6.56968812e+03  6.55033101e+03  1.24e-05 1.27e-07  1.72e-04   832s
  34   6.56030588e+03  6.54925401e+03  6.93e-06 3.70e-06  9.10e-05   855s
  35   6.55481222e+03  6.54854323e+03  3.76e-06 1.89e-05  4.29e-05   879s
  36   6.55171344e+03  6.54838387e+03  1.98e-06 2.47e-06  2.17e-05   901s
  37   6.55000581e+03  6.54829527e+03  9.97e-07 1.64e-05  1.03e-05   924s
  38   6.54841209e+03  6.54824701e+03  9.91e-08 1.74e-07  1.14e-06   951s
  39   6.54826108e+03  6.54824301e+03  1.19e-08 2.43e-06  1.80e-07   976s
  40   6.54824509e+03  6.54824173e+03  2.18e-09 1.36e-06  3.12e-08  1000s
  41   6.54824258e+03  6.54824161e+03  6.88e-10 1.87e-05  9.80e-09  1023s
  42   6.54824194e+03  6.54824158e+03  1.61e-10 1.36e-05  2.38e-09  1045s
  43   6.54824081e+03  6.54824157e+03  1.08e-10 1.23e-06  9.46e-10  1068s

Barrier solved model in 43 iterations and 1067.98 seconds
Optimal objective 6.54824081e+03

Optimization finished!
