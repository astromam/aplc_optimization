Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.82},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0195_OD0965_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6768 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [1e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 12s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 51s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 58s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 59.05s
Presolved: 6768 rows, 20517 columns, 93059990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.87284058e+06  3.21467759e+04  2.34e+01 0.00e+00  9.24e+02   102s
   1   1.39937348e+04  3.20872331e+04  4.14e-02 1.09e-11  2.28e+00   125s
   2   7.14545340e+03  1.64741960e+04  4.80e-03 2.11e-09  3.75e-01   148s
   3   7.13465780e+03  9.67330660e+03  1.92e-03 3.35e-09  1.02e-01   172s
   4   7.06588972e+03  7.88019410e+03  7.36e-04 6.41e-09  3.15e-02   196s
   5   7.08163080e+03  7.49184268e+03  4.23e-04 6.29e-09  1.59e-02   220s
   6   7.09039413e+03  7.39510221e+03  3.04e-04 8.22e-09  1.15e-02   243s
   7   7.09878793e+03  7.27344611e+03  2.22e-04 9.26e-09  7.08e-03   267s
   8   7.10353895e+03  7.23187785e+03  1.64e-04 8.78e-09  5.17e-03   290s
   9   7.10759038e+03  7.18689966e+03  1.28e-04 1.21e-08  3.50e-03   314s
  10   7.10915246e+03  7.17176145e+03  1.07e-04 1.07e-08  2.82e-03   337s
  11   7.11288717e+03  7.15959050e+03  8.72e-05 8.53e-09  2.19e-03   360s
  12   7.11342492e+03  7.15441983e+03  8.17e-05 9.81e-09  1.98e-03   383s
  13   7.11459698e+03  7.14670938e+03  6.87e-05 8.18e-09  1.60e-03   407s
  14   7.11731734e+03  7.13700466e+03  5.12e-05 1.05e-08  1.09e-03   430s
  15   7.11863203e+03  7.13312184e+03  3.99e-05 1.58e-08  8.26e-04   454s
  16   7.11974532e+03  7.12982410e+03  3.21e-05 9.96e-09  6.25e-04   477s
  17   7.12114234e+03  7.12562253e+03  2.01e-05 1.34e-08  3.46e-04   502s
  18   7.12159442e+03  7.12361636e+03  1.11e-05 9.51e-09  1.80e-04   527s
  19   7.12180138e+03  7.12287748e+03  6.68e-06 1.23e-08  1.05e-04   551s
  20   7.12189128e+03  7.12241908e+03  3.87e-06 1.06e-08  5.84e-05   574s
  21   7.12191514e+03  7.12204437e+03  1.43e-06 2.62e-08  1.99e-05   601s
  22   7.12196028e+03  7.12198886e+03  2.46e-08 2.10e-08  9.86e-07   628s
  23   7.12197057e+03  7.12197750e+03  4.46e-09 1.63e-08  2.21e-07   651s
  24   7.12197325e+03  7.12197384e+03  7.98e-11 1.59e-08  1.52e-08   679s
  25   7.12197340e+03  7.12197346e+03  2.53e-12 1.18e-08  1.44e-09   703s

Barrier solved model in 25 iterations and 702.94 seconds
Optimal objective 7.12197340e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [1e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 58.64s
Presolved: 6768 rows, 20517 columns, 93059990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.87284058e+06  3.17352060e+04  2.34e+01 0.00e+00  9.24e+02   102s
   1   1.39930734e+04  3.16754559e+04  4.14e-02 1.09e-11  2.27e+00   125s
   2   7.23556167e+03  1.60973494e+04  5.31e-03 2.21e-09  3.82e-01   148s
   3   7.12079930e+03  9.68836513e+03  2.30e-03 4.53e-09  1.15e-01   172s
   4   7.04579968e+03  7.83208076e+03  1.12e-03 7.33e-09  3.91e-02   195s
   5   7.05028343e+03  7.48971625e+03  7.14e-04 9.00e-09  2.21e-02   218s
   6   7.04491091e+03  7.37240146e+03  5.61e-04 1.35e-08  1.66e-02   241s
   7   7.03858878e+03  7.26575342e+03  3.57e-04 2.07e-08  1.08e-02   266s
   8   7.03386545e+03  7.17052749e+03  2.39e-04 1.23e-08  6.81e-03   290s
   9   7.02976584e+03  7.13194389e+03  1.78e-04 1.01e-08  5.06e-03   314s
  10   7.02919915e+03  7.10475199e+03  1.50e-04 1.57e-08  4.03e-03   337s
  11   7.02678509e+03  7.07584594e+03  1.15e-04 1.61e-08  2.86e-03   361s
  12   7.02622926e+03  7.05223711e+03  9.05e-05 2.08e-08  1.95e-03   386s
  13   7.02449961e+03  7.03705623e+03  6.21e-05 1.60e-07  1.22e-03   410s
  14   7.02328299e+03  7.03124166e+03  4.66e-05 1.25e-07  8.85e-04   434s
  15   7.02212920e+03  7.02779673e+03  3.65e-05 4.58e-08  6.83e-04   457s
  16   7.02045458e+03  7.02211575e+03  2.11e-05 1.73e-07  3.56e-04   482s
  17   7.01954936e+03  7.02005394e+03  1.47e-05 3.12e-07  2.34e-04   505s
  18   7.01902457e+03  7.01902016e+03  9.42e-06 1.77e-08  1.42e-04   529s
  19   7.01795179e+03  7.01815994e+03  3.88e-06 1.47e-08  6.39e-05   553s
  20   7.01771355e+03  7.01780420e+03  2.50e-06 2.89e-08  4.02e-05   576s
  21   7.01759921e+03  7.01756702e+03  1.66e-06 1.45e-07  2.45e-05   599s
  22   7.01739522e+03  7.01739325e+03  5.76e-07 6.12e-08  8.71e-06   624s
  23   7.01729128e+03  7.01730760e+03  7.82e-09 2.56e-08  5.17e-07   649s
  24   7.01729427e+03  7.01729533e+03  9.54e-11 2.17e-08  2.72e-08   676s
  25   7.01729447e+03  7.01729455e+03  3.18e-12 2.22e-08  1.60e-09   702s

Barrier solved model in 25 iterations and 702.22 seconds
Optimal objective 7.01729447e+03

Optimization finished!
