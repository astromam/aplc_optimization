Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.92},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3.25,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0192_OD0951_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6720 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13440 rows, 13749 columns and 184786556 nonzeros
Coefficient statistics:
  Matrix range     [4e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6720 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6720 rows and 0 columns
Presolve time: 58.37s
Presolved: 6720 rows, 20469 columns, 92399996 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.258e+07
 Factor NZ  : 2.258e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.012e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69669526e+06  3.17043542e+04  2.64e+01 0.00e+00  9.23e+02   101s
   1   1.34550505e+04  3.16473964e+04  4.53e-02 1.09e-11  2.22e+00   123s
   2   7.72382846e+03  1.61487067e+04  9.41e-03 2.32e-09  4.61e-01   146s
   3   7.23175918e+03  9.77073217e+03  2.62e-03 4.57e-09  1.12e-01   169s
   4   7.03510701e+03  7.89324428e+03  1.16e-03 7.22e-09  3.75e-02   192s
   5   7.00215041e+03  7.44325648e+03  6.40e-04 2.16e-08  1.85e-02   216s
   6   6.99360766e+03  7.25378542e+03  4.02e-04 2.74e-08  1.09e-02   239s
   7   6.99426707e+03  7.17177016e+03  2.91e-04 2.78e-08  7.49e-03   262s
   8   6.99504638e+03  7.11301199e+03  2.05e-04 1.63e-08  5.04e-03   285s
   9   6.99849025e+03  7.06656626e+03  1.40e-04 8.57e-09  3.11e-03   309s
  10   7.00020968e+03  7.04130508e+03  1.00e-04 2.27e-08  2.03e-03   332s
  11   7.00111217e+03  7.02819333e+03  7.45e-05 3.04e-08  1.42e-03   356s
  12   7.00185618e+03  7.02042516e+03  6.01e-05 2.63e-08  1.06e-03   379s
  13   7.00260006e+03  7.01292904e+03  3.83e-05 1.05e-08  6.37e-04   403s
  14   7.00274929e+03  7.00718926e+03  2.26e-05 3.68e-08  3.35e-04   427s
  15   7.00281413e+03  7.00484587e+03  9.35e-06 1.21e-08  1.43e-04   451s
  16   7.00299560e+03  7.00356020e+03  3.00e-06 3.68e-08  4.39e-05   475s
  17   7.00312481e+03  7.00340954e+03  1.33e-06 2.58e-08  2.03e-05   498s
  18   7.00318707e+03  7.00322779e+03  8.55e-08 1.65e-08  1.85e-06   523s
  19   7.00320227e+03  7.00320531e+03  2.91e-09 1.48e-08  1.04e-07   548s
  20   7.00320388e+03  7.00320417e+03  7.00e-11 1.20e-08  7.93e-09   573s
  21   7.00320400e+03  7.00320400e+03  1.05e-11 1.56e-08  3.48e-10   599s

Barrier solved model in 21 iterations and 598.66 seconds
Optimal objective 7.00320400e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13440 rows, 13749 columns and 184786556 nonzeros
Coefficient statistics:
  Matrix range     [4e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6720 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6720 rows and 0 columns
Presolve time: 58.11s
Presolved: 6720 rows, 20469 columns, 92399996 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.258e+07
 Factor NZ  : 2.258e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.012e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69669526e+06  3.13068727e+04  2.64e+01 0.00e+00  9.23e+02   101s
   1   1.34553580e+04  3.12497159e+04  4.53e-02 1.09e-11  2.21e+00   123s
   2   8.01707754e+03  1.57295041e+04  1.12e-02 1.56e-09  4.98e-01   146s
   3   7.27104363e+03  9.72226071e+03  2.71e-03 4.89e-09  1.17e-01   170s
   4   7.08340855e+03  7.97985540e+03  1.46e-03 5.04e-09  4.59e-02   193s
   5   6.97101835e+03  7.41635075e+03  7.27e-04 8.56e-09  2.12e-02   216s
   6   6.94682648e+03  7.21858337e+03  4.96e-04 3.33e-08  1.31e-02   239s
   7   6.93458677e+03  7.09611067e+03  3.54e-04 1.25e-08  8.27e-03   262s
   8   6.92039718e+03  7.01048870e+03  2.14e-04 9.86e-09  4.68e-03   287s
   9   6.91849974e+03  6.98642064e+03  1.84e-04 9.40e-09  3.77e-03   310s
  10   6.91716328e+03  6.96061715e+03  1.30e-04 6.47e-08  2.54e-03   334s
  11   6.91563526e+03  6.93900347e+03  9.46e-05 1.36e-08  1.63e-03   357s
  12   6.91465103e+03  6.93192634e+03  8.12e-05 2.55e-08  1.32e-03   380s
  13   6.91346998e+03  6.92260041e+03  5.43e-05 7.57e-08  8.23e-04   403s
  14   6.91278743e+03  6.91811882e+03  4.07e-05 6.34e-08  5.79e-04   427s
  15   6.91227335e+03  6.91392634e+03  2.66e-05 1.19e-07  3.33e-04   450s
  16   6.91133645e+03  6.91196009e+03  1.57e-05 8.14e-08  1.87e-04   474s
  17   6.91071154e+03  6.91099789e+03  8.76e-06 9.86e-08  1.03e-04   497s
  18   6.91024551e+03  6.91039725e+03  3.67e-06 5.38e-08  4.40e-05   521s
  19   6.90996793e+03  6.91006222e+03  8.66e-08 1.36e-08  3.25e-06   546s
  20   6.90998288e+03  6.91001274e+03  1.72e-08 1.86e-08  9.19e-07   569s
  21   6.90998661e+03  6.90999806e+03  3.23e-09 4.61e-08  3.15e-07   594s
  22   6.90998762e+03  6.90998952e+03  1.02e-10 1.46e-08  4.75e-08   619s
  23   6.90998772e+03  6.90998791e+03  9.61e-12 1.71e-08  4.69e-09   644s
  24   6.90998773e+03  6.90998776e+03  7.55e-12 2.37e-08  4.67e-10   667s

Barrier solved model in 24 iterations and 667.40 seconds
Optimal objective 6.90998773e+03

Optimization finished!
