Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.92},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3.5,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0190_OD0937_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6592 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13184 rows, 13749 columns and 181266814 nonzeros
Coefficient statistics:
  Matrix range     [2e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 57.13s
Presolved: 6592 rows, 20341 columns, 90639990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53923327e+06  3.03584495e+04  3.03e+01 1.82e-12  9.05e+02    98s
   1   9.87069575e+03  3.03056005e+04  3.04e-02 3.42e-10  1.52e+00   120s
   2   7.39677763e+03  1.66979311e+04  8.96e-03 2.96e-09  4.42e-01   142s
   3   7.12850154e+03  9.61722247e+03  3.95e-03 5.05e-09  1.25e-01   164s
   4   6.89724913e+03  7.85643421e+03  1.22e-03 6.64e-09  3.83e-02   187s
   5   6.90291540e+03  7.35248622e+03  5.92e-04 1.08e-08  1.70e-02   209s
   6   6.91633180e+03  7.19352785e+03  3.07e-04 9.02e-09  9.69e-03   232s
   7   6.92672878e+03  7.11606748e+03  1.84e-04 7.20e-09  6.32e-03   254s
   8   6.93333067e+03  7.06453000e+03  1.34e-04 6.34e-09  4.41e-03   276s
   9   6.93807485e+03  7.02974164e+03  1.03e-04 8.59e-09  3.15e-03   298s
  10   6.94145695e+03  7.01144834e+03  8.14e-05 8.08e-09  2.42e-03   320s
  11   6.94624016e+03  6.98632804e+03  5.64e-05 7.11e-09  1.46e-03   343s
  12   6.95070355e+03  6.96892030e+03  3.17e-05 9.14e-09  7.15e-04   366s
  13   6.95348815e+03  6.96356899e+03  1.87e-05 9.78e-09  4.05e-04   388s
  14   6.95499753e+03  6.96125540e+03  1.19e-05 1.00e-08  2.54e-04   410s
  15   6.95596330e+03  6.95914319e+03  7.38e-06 8.44e-09  1.40e-04   433s
  16   6.95652231e+03  6.95840866e+03  4.01e-06 1.27e-08  8.00e-05   456s
  17   6.95714206e+03  6.95751767e+03  4.69e-07 1.04e-08  1.32e-05   479s
  18   6.95727478e+03  6.95730389e+03  2.36e-08 2.10e-08  9.14e-07   504s
  19   6.95728608e+03  6.95728868e+03  1.46e-09 9.72e-09  7.61e-08   527s
  20   6.95728711e+03  6.95728732e+03  1.11e-10 1.30e-08  6.25e-09   551s
  21   6.95728720e+03  6.95728722e+03  1.07e-11 1.16e-08  3.12e-10   576s

Barrier solved model in 21 iterations and 575.78 seconds
Optimal objective 6.95728720e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13184 rows, 13749 columns and 181266814 nonzeros
Coefficient statistics:
  Matrix range     [2e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 56.67s
Presolved: 6592 rows, 20341 columns, 90639990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53923327e+06  2.99960705e+04  3.03e+01 1.82e-12  9.05e+02    98s
   1   9.95759383e+03  2.99430336e+04  3.10e-02 3.69e-10  1.53e+00   119s
   2   7.59927906e+03  1.65378269e+04  1.08e-02 3.36e-09  4.81e-01   141s
   3   7.20843099e+03  9.45644046e+03  4.61e-03 5.16e-09  1.34e-01   163s
   4   6.94182474e+03  8.00789942e+03  1.88e-03 1.71e-08  5.25e-02   186s
   5   6.89427552e+03  7.40715622e+03  1.04e-03 5.88e-09  2.46e-02   208s
   6   6.88618372e+03  7.20198385e+03  6.06e-04 1.63e-08  1.43e-02   230s
   7   6.88337817e+03  7.10858497e+03  4.76e-04 5.24e-08  1.05e-02   252s
   8   6.88139054e+03  7.03366027e+03  3.65e-04 3.03e-08  7.40e-03   274s
   9   6.88027054e+03  7.00009722e+03  3.06e-04 1.20e-08  5.96e-03   296s
  10   6.87924558e+03  6.96963817e+03  2.53e-04 1.12e-08  4.68e-03   318s
  11   6.88012630e+03  6.94168122e+03  1.86e-04 9.24e-09  3.30e-03   340s
  12   6.88058344e+03  6.91854432e+03  1.38e-04 9.80e-09  2.25e-03   363s
  13   6.88002940e+03  6.91195459e+03  1.16e-04 1.18e-08  1.89e-03   385s
  14   6.88039955e+03  6.90155218e+03  9.11e-05 1.01e-08  1.38e-03   407s
  15   6.88022273e+03  6.89236228e+03  5.73e-05 1.39e-08  8.40e-04   429s
  16   6.87941194e+03  6.88372863e+03  3.21e-05 1.37e-08  4.08e-04   454s
  17   6.87912091e+03  6.88142499e+03  2.13e-05 1.18e-08  2.57e-04   476s
  18   6.87848806e+03  6.87960966e+03  7.60e-06 1.71e-08  9.91e-05   499s
  19   6.87850059e+03  6.87890088e+03  3.93e-06 1.43e-08  4.68e-05   522s
  20   6.87841729e+03  6.87856950e+03  1.55e-06 1.77e-08  1.83e-05   545s
  21   6.87837957e+03  6.87840354e+03  1.97e-07 1.67e-08  2.44e-06   569s
  22   6.87838074e+03  6.87838668e+03  5.59e-08 8.34e-08  6.72e-07   592s
  23   6.87838134e+03  6.87838271e+03  1.22e-08 8.36e-08  1.49e-07   615s
  24   6.87838168e+03  6.87838203e+03  2.78e-09 1.45e-08  3.49e-08   638s
  25   6.87838182e+03  6.87838189e+03  9.28e-12 4.03e-08  1.83e-09   662s
  26   6.87838184e+03  6.87838184e+03  1.75e-12 1.34e-08  1.99e-11   684s

Barrier solved model in 26 iterations and 683.99 seconds
Optimal objective 6.87838184e+03

Optimization finished!
