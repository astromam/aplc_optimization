Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.72},
 'image': {'bandwidth': 0.16,
           'contrast': 10,
           'iwa': 3.5,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0192_OD0951_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6592 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13184 rows, 13749 columns and 181266812 nonzeros
Coefficient statistics:
  Matrix range     [2e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 56.96s
Presolved: 6592 rows, 20341 columns, 90639996 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69929893e+06  3.08332527e+04  2.89e+01 1.82e-12  9.12e+02    98s
   1   1.06863717e+04  3.07781566e+04  3.30e-02 6.51e-10  1.67e+00   120s
   2   6.70766002e+03  1.34439058e+04  2.81e-03 5.75e-09  2.27e-01   142s
   3   6.99749958e+03  9.53966120e+03  1.44e-03 3.84e-09  8.43e-02   164s
   4   7.08064024e+03  7.92879861e+03  7.17e-04 5.70e-09  2.89e-02   186s
   5   7.13802679e+03  7.66450147e+03  4.37e-04 3.16e-08  1.75e-02   208s
   6   7.17341536e+03  7.46104669e+03  2.59e-04 3.14e-08  9.62e-03   230s
   7   7.19385967e+03  7.34692796e+03  1.86e-04 3.42e-08  5.53e-03   253s
   8   7.20334927e+03  7.31374786e+03  1.43e-04 2.87e-08  4.05e-03   275s
   9   7.21010964e+03  7.29399076e+03  1.14e-04 1.37e-08  3.13e-03   297s
  10   7.21790631e+03  7.27485968e+03  8.89e-05 3.63e-08  2.22e-03   319s
  11   7.22377852e+03  7.26172445e+03  6.81e-05 2.93e-08  1.56e-03   342s
  12   7.22817332e+03  7.25569687e+03  5.15e-05 4.67e-08  1.15e-03   364s
  13   7.23275188e+03  7.24704556e+03  3.29e-05 1.39e-07  6.55e-04   388s
  14   7.23554869e+03  7.24264611e+03  2.12e-05 1.74e-07  3.70e-04   411s
  15   7.23656543e+03  7.24167477e+03  1.55e-05 1.20e-07  2.69e-04   433s
  16   7.23743003e+03  7.24073376e+03  1.11e-05 1.34e-08  1.83e-04   455s
  17   7.23819649e+03  7.24023072e+03  6.62e-06 1.00e-08  1.11e-04   478s
  18   7.23871289e+03  7.23963362e+03  3.15e-06 2.37e-08  5.18e-05   502s
  19   7.23903789e+03  7.23944767e+03  1.34e-06 1.06e-08  2.24e-05   524s
  20   7.23921915e+03  7.23936180e+03  4.14e-07 6.08e-08  7.34e-06   547s
  21   7.23930578e+03  7.23932331e+03  7.95e-09 5.03e-08  5.04e-07   570s
  22   7.23931229e+03  7.23931396e+03  7.55e-10 1.22e-08  4.81e-08   596s
  23   7.23931287e+03  7.23931335e+03  2.61e-10 1.48e-08  1.42e-08   619s
  24   7.23931318e+03  7.23931321e+03  4.73e-12 1.23e-08  7.11e-10   642s

Barrier solved model in 24 iterations and 642.19 seconds
Optimal objective 7.23931318e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13184 rows, 13749 columns and 181266812 nonzeros
Coefficient statistics:
  Matrix range     [2e-13, 2e-04]
  Objective range  [3e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 28s) ...
Presolve removed 0 rows and 0 columns (presolve time = 49s) ...
Presolve removed 6592 rows and 0 columns (presolve time = 56s) ...
Presolve removed 6592 rows and 0 columns
Presolve time: 56.76s
Presolved: 6592 rows, 20341 columns, 90639996 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.172e+07
 Factor NZ  : 2.173e+07 (roughly 200 MBytes of memory)
 Factor Ops : 9.551e+10 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.69929893e+06  3.04755147e+04  2.89e+01 1.82e-12  9.12e+02    98s
   1   1.06930600e+04  3.04202374e+04  3.31e-02 5.28e-10  1.66e+00   120s
   2   6.69426154e+03  1.31783696e+04  2.77e-03 3.66e-09  2.22e-01   142s
   3   6.97055140e+03  8.73551184e+03  1.26e-03 3.94e-09  6.24e-02   164s
   4   7.06126700e+03  7.94831888e+03  8.83e-04 4.12e-09  3.30e-02   186s
   5   7.08781649e+03  7.62929207e+03  6.31e-04 6.48e-09  2.07e-02   208s
   6   7.11376621e+03  7.47359607e+03  4.56e-04 1.73e-08  1.39e-02   230s
   7   7.13086419e+03  7.36187011e+03  3.56e-04 1.49e-08  9.58e-03   253s
   8   7.13575641e+03  7.32725427e+03  2.79e-04 2.92e-08  7.75e-03   274s
   9   7.14399884e+03  7.25136680e+03  1.99e-04 5.29e-08  4.76e-03   298s
  10   7.14569849e+03  7.22665991e+03  1.64e-04 3.82e-08  3.72e-03   320s
  11   7.15008499e+03  7.20795280e+03  1.39e-04 4.66e-08  2.87e-03   343s
  12   7.15213177e+03  7.19536128e+03  1.18e-04 8.64e-08  2.29e-03   365s
  13   7.15363017e+03  7.18618973e+03  9.92e-05 5.45e-08  1.83e-03   387s
  14   7.15445935e+03  7.18029932e+03  8.60e-05 2.51e-08  1.52e-03   409s
  15   7.15715147e+03  7.17418204e+03  7.19e-05 1.63e-08  1.16e-03   431s
  16   7.15918854e+03  7.17030899e+03  5.45e-05 3.60e-08  8.30e-04   454s
  17   7.15996625e+03  7.16643962e+03  3.95e-05 8.70e-08  5.61e-04   476s
  18   7.16042150e+03  7.16403394e+03  3.23e-05 5.68e-08  4.17e-04   499s
  19   7.16066871e+03  7.16264632e+03  1.96e-05 4.32e-08  2.48e-04   522s
  20   7.16084532e+03  7.16123586e+03  1.15e-05 4.77e-08  1.26e-04   545s
  21   7.16073121e+03  7.16079196e+03  6.88e-06 3.07e-08  7.13e-05   568s
  22   7.16065888e+03  7.16068059e+03  4.15e-06 3.24e-08  4.26e-05   590s
  23   7.16055108e+03  7.16062620e+03  1.38e-06 2.03e-08  1.59e-05   613s
  24   7.16053754e+03  7.16056163e+03  3.45e-08 9.14e-08  9.42e-07   638s
  25   7.16054196e+03  7.16055120e+03  1.25e-08 5.22e-08  3.54e-07   661s
  26   7.16054447e+03  7.16054523e+03  3.89e-10 2.63e-08  2.25e-08   686s
  27   7.16054476e+03  7.16054480e+03  4.74e-12 1.89e-08  9.48e-10   710s

Barrier solved model in 27 iterations and 709.55 seconds
Optimal objective 7.16054476e+03

Optimization finished!
