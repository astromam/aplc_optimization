Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.82},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3.25,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0195_OD0965_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_local'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6720 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13440 rows, 13749 columns and 184786556 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [1e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6720 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6720 rows and 0 columns
Presolve time: 58.32s
Presolved: 6720 rows, 20469 columns, 92399990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.258e+07
 Factor NZ  : 2.258e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.012e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.87284621e+06  3.21335518e+04  2.36e+01 0.00e+00  9.24e+02   101s
   1   1.42636148e+04  3.20741190e+04  4.29e-02 1.09e-11  2.33e+00   124s
   2   6.88420902e+03  1.66980670e+04  3.40e-03 2.08e-09  3.45e-01   146s
   3   7.02145164e+03  1.02171573e+04  1.86e-03 4.40e-09  1.17e-01   169s
   4   7.03238158e+03  8.09750226e+03  9.17e-04 4.02e-09  4.04e-02   192s
   5   7.06592877e+03  7.59768143e+03  5.31e-04 6.26e-09  2.04e-02   216s
   6   7.08059453e+03  7.40754211e+03  3.74e-04 6.89e-09  1.29e-02   239s
   7   7.09668284e+03  7.28702599e+03  2.58e-04 8.83e-09  7.90e-03   262s
   8   7.10420386e+03  7.22913592e+03  2.01e-04 7.35e-09  5.53e-03   285s
   9   7.11049764e+03  7.19686499e+03  1.32e-04 8.26e-09  3.72e-03   310s
  10   7.11376637e+03  7.16967203e+03  1.07e-04 1.04e-08  2.66e-03   333s
  11   7.11640300e+03  7.15561977e+03  7.81e-05 8.92e-09  1.89e-03   356s
  12   7.11777669e+03  7.14567509e+03  6.61e-05 9.38e-09  1.47e-03   380s
  13   7.12042595e+03  7.13663001e+03  5.20e-05 9.38e-09  1.01e-03   404s
  14   7.12231811e+03  7.12946369e+03  3.92e-05 1.28e-08  6.39e-04   429s
  15   7.12309647e+03  7.12782049e+03  2.69e-05 1.07e-08  4.33e-04   453s
  16   7.12359768e+03  7.12612861e+03  1.90e-05 9.11e-09  2.87e-04   477s
  17   7.12391206e+03  7.12543863e+03  1.44e-05 1.33e-08  2.08e-04   501s
  18   7.12409714e+03  7.12456903e+03  8.10e-06 1.11e-08  1.07e-04   526s
  19   7.12402996e+03  7.12432154e+03  4.96e-06 1.31e-08  6.58e-05   549s
  20   7.12397304e+03  7.12414326e+03  1.95e-06 1.10e-08  2.71e-05   572s
  21   7.12394985e+03  7.12400323e+03  3.82e-07 1.84e-08  5.82e-06   597s
  22   7.12395419e+03  7.12397389e+03  1.40e-07 1.06e-08  2.14e-06   620s
  23   7.12395770e+03  7.12396332e+03  3.66e-10 1.24e-08  1.42e-07   644s
  24   7.12395840e+03  7.12396065e+03  1.34e-10 1.05e-08  5.66e-08   667s
  25   7.12395873e+03  7.12395887e+03  1.93e-11 1.21e-08  3.60e-09   692s
  26   7.12395881e+03  7.12395882e+03  8.59e-12 1.41e-08  1.66e-10   717s

Barrier solved model in 26 iterations and 716.88 seconds
Optimal objective 7.12395881e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13440 rows, 13749 columns and 184786556 nonzeros
Coefficient statistics:
  Matrix range     [3e-13, 2e-04]
  Objective range  [1e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 11s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 29s) ...
Presolve removed 0 rows and 0 columns (presolve time = 50s) ...
Presolve removed 6720 rows and 0 columns (presolve time = 57s) ...
Presolve removed 6720 rows and 0 columns
Presolve time: 57.89s
Presolved: 6720 rows, 20469 columns, 92399990 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.258e+07
 Factor NZ  : 2.258e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.012e+11 (roughly 3 seconds per iteration)
 Threads    : 6

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.87284621e+06  3.17251458e+04  2.36e+01 0.00e+00  9.24e+02   100s
   1   1.42634499e+04  3.16655074e+04  4.29e-02 1.18e-11  2.32e+00   123s
   2   6.98911018e+03  1.63256775e+04  3.99e-03 2.98e-09  3.53e-01   146s
   3   7.10035382e+03  9.92923861e+03  2.25e-03 4.38e-09  1.20e-01   169s
   4   7.05634620e+03  8.21128414e+03  1.05e-03 6.53e-09  4.79e-02   192s
   5   7.02738901e+03  7.60880784e+03  5.65e-04 9.41e-09  2.38e-02   216s
   6   7.01266389e+03  7.37499907e+03  2.76e-04 1.12e-08  1.32e-02   239s
   7   7.01021892e+03  7.18164392e+03  1.70e-04 1.99e-08  6.74e-03   263s
   8   7.01092788e+03  7.13775729e+03  1.08e-04 1.50e-08  4.73e-03   286s
   9   7.01087404e+03  7.10181661e+03  8.40e-05 1.21e-08  3.49e-03   309s
  10   7.01163763e+03  7.07329396e+03  5.72e-05 1.28e-08  2.37e-03   332s
  11   7.01251041e+03  7.05642729e+03  4.53e-05 1.34e-08  1.76e-03   355s
  12   7.01343596e+03  7.04052648e+03  3.16e-05 1.56e-08  1.14e-03   379s
  13   7.01489824e+03  7.03029244e+03  2.07e-05 1.61e-08  6.90e-04   402s
  14   7.01582971e+03  7.02475815e+03  1.46e-05 1.77e-08  4.40e-04   425s
  15   7.01651584e+03  7.02289140e+03  8.30e-06 1.91e-08  2.82e-04   448s
  16   7.01687274e+03  7.01986268e+03  5.41e-06 1.57e-08  1.56e-04   472s
  17   7.01726108e+03  7.01809173e+03  1.54e-06 2.39e-08  4.39e-05   496s
  18   7.01754529e+03  7.01763013e+03  6.90e-08 2.31e-08  3.13e-06   522s
  19   7.01758248e+03  7.01759708e+03  8.99e-09 2.61e-08  4.94e-07   546s
  20   7.01758938e+03  7.01759221e+03  1.88e-09 3.24e-08  9.79e-08   571s
  21   7.01759136e+03  7.01759153e+03  1.51e-11 2.21e-08  4.38e-09   596s
  22   7.01759140e+03  7.01759142e+03  4.98e-12 2.52e-08  2.26e-10   620s

Barrier solved model in 22 iterations and 619.61 seconds
Optimal objective 7.01759140e+03

Optimization finished!
