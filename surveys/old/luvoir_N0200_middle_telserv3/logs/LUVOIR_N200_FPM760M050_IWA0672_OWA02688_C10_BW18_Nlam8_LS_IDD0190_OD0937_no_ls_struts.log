Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 7.6},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 6.72,
           'num_wavelengths': 8,
           'owa': 26.88,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0190_OD0937_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 34080 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 68160 rows, 13749 columns and 937131828 nonzeros
Coefficient statistics:
  Matrix range     [1e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 30s) ...
Presolve removed 0 rows and 0 columns (presolve time = 53s) ...
Presolve removed 0 rows and 0 columns (presolve time = 94s) ...
Presolve removed 0 rows and 0 columns (presolve time = 184s) ...
Presolve removed 0 rows and 0 columns (presolve time = 195s) ...
Presolve time: 215.71s
Presolved: 13749 rows, 81909 columns, 937145577 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 9.451e+07
 Factor NZ  : 9.452e+07 (roughly 800 MBytes of memory)
 Factor Ops : 8.664e+11 (roughly 22 seconds per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.71779784e+04  0.00000000e+00  0.00e+00 0.00e+00  1.18e+00   460s
   1   2.17908559e+04  3.56378748e+03  0.00e+00 2.65e-02  2.36e-01   591s
   2   1.60261313e+04  6.35210040e+03  0.00e+00 9.68e-03  1.14e-01   721s
   3   1.17797784e+04  7.43878957e+03  0.00e+00 5.30e-03  4.82e-02   857s
   4   1.04680693e+04  7.71280624e+03  0.00e+00 3.32e-03  3.00e-02   992s
   5   9.18281710e+03  7.86532847e+03  0.00e+00 2.19e-03  1.42e-02  1130s
   6   8.73156124e+03  7.99489957e+03  0.00e+00 1.10e-03  7.85e-03  1267s
   7   8.44214890e+03  8.05329199e+03  0.00e+00 6.67e-04  4.13e-03  1394s
   8   8.30330086e+03  8.10321104e+03  0.00e+00 3.66e-04  2.12e-03  1528s
   9   8.24421088e+03  8.12745672e+03  0.00e+00 2.35e-04  1.23e-03  1657s
  10   8.21401493e+03  8.14198493e+03  0.00e+00 1.58e-04  7.61e-04  1784s
  11   8.19925638e+03  8.15197772e+03  0.00e+00 1.03e-04  4.99e-04  1919s
  12   8.18358905e+03  8.16114349e+03  0.00e+00 5.52e-05  2.37e-04  2057s
  13   8.17632014e+03  8.16494812e+03  0.00e+00 3.48e-05  1.20e-04  2187s
  14   8.17298802e+03  8.16840042e+03  0.00e+00 1.50e-05  4.86e-05  2322s
  15   8.17171763e+03  8.16992579e+03  0.00e+00 6.41e-06  1.90e-05  2455s
  16   8.17149063e+03  8.17057985e+03  0.00e+00 2.85e-06  9.64e-06  2581s
  17   8.17129534e+03  8.17082352e+03  0.00e+00 1.51e-06  5.00e-06  2715s
  18   8.17113598e+03  8.17102272e+03  0.00e+00 4.04e-07  1.20e-06  2848s
  19   8.17111768e+03  8.17108039e+03  1.76e-07 9.64e-08  3.94e-07  2984s
  20   8.17110371e+03  8.17109212e+03  3.66e-08 3.62e-08  1.23e-07  3135s
  21   8.17110079e+03  8.17109622e+03  1.79e-08 1.57e-08  4.85e-08  3282s
  22   8.17109965e+03  8.17109880e+03  2.51e-08 2.98e-09  9.05e-09  3443s
  23   8.17109965e+03  8.17109929e+03  6.11e-08 6.22e-10  3.73e-09  3603s
  24   8.17109965e+03  8.17109936e+03  7.57e-08 3.02e-10  2.99e-09  3748s
  25   8.17109965e+03  8.17109938e+03  1.22e-07 2.37e-10  2.84e-09  3882s
  26   8.17109964e+03  8.17109938e+03  2.38e-07 2.33e-10  2.83e-09  4016s
  27   8.17109964e+03  8.17109938e+03  4.03e-07 2.15e-10  2.78e-09  4161s
  28   8.17109964e+03  8.17109939e+03  4.74e-07 1.61e-10  2.63e-09  4305s
  29   8.17109964e+03  8.17109941e+03  6.62e-07 6.93e-11  2.41e-09  4474s
  30   8.17109963e+03  8.17109942e+03  7.19e-07 3.82e-11  2.32e-09  4626s
  31   8.17109963e+03  8.17109942e+03  7.07e-07 3.81e-11  2.32e-09  4769s
  32   8.17109963e+03  8.17109942e+03  1.19e-06 2.54e-11  2.28e-09  4906s
  33   8.17109964e+03  8.17109942e+03  1.28e-06 2.50e-11  2.28e-09  5045s
  34   8.17109962e+03  8.17109941e+03  2.41e-06 1.03e-12  2.37e-09  5208s
  35   8.17109963e+03  8.17109941e+03  3.06e-06 1.33e-12  2.25e-09  5345s
  36   8.17109967e+03  8.17109943e+03  5.15e-06 1.12e-12  1.91e-09  5493s
  37   8.17109976e+03  8.17109943e+03  6.06e-06 1.35e-12  1.90e-09  5641s
  38   8.17109986e+03  8.17109943e+03  9.87e-06 1.25e-12  1.65e-09  5804s
  39   8.17109975e+03  8.17109943e+03  1.81e-05 1.37e-12  1.16e-09  5963s
  40   8.17109929e+03  8.17109943e+03  1.57e-05 1.46e-12  6.31e-10  6107s
  41   8.17109884e+03  8.17109943e+03  1.27e-05 1.30e-12  2.38e-10  6252s
  42   8.17109888e+03  8.17109943e+03  1.50e-05 1.54e-12  2.38e-10  6390s
  43   8.17109946e+03  8.17109943e+03  1.67e-05 1.36e-12  2.16e-10  6531s
  44   8.17109949e+03  8.17109943e+03  1.64e-05 1.65e-12  1.89e-10  6676s
  45   8.17109958e+03  8.17109943e+03  1.97e-05 1.41e-12  4.23e-12  6813s
  46   8.17109997e+03  8.17109943e+03  2.31e-05 1.21e-12  3.73e-12  6990s
  47   8.17109998e+03  8.17109943e+03  4.27e-05 1.17e-12  3.12e-12  7135s
  48   8.17109998e+03  8.17109943e+03  4.17e-05 1.21e-12  3.12e-12  7275s
  49   8.17109996e+03  8.17109943e+03  4.33e-05 1.11e-12  3.12e-12  7423s
  50   8.17110000e+03  8.17109943e+03  4.59e-05 8.58e-13  2.84e-12  7633s
  51   8.17110003e+03  8.17109943e+03  4.76e-05 7.90e-13  2.62e-12  7795s

Barrier solved model in 51 iterations and 7794.81 seconds
Optimal objective 8.17109965e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 68160 rows, 13749 columns and 937131828 nonzeros
Coefficient statistics:
  Matrix range     [1e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-06, 8e-06]
Presolve removed 0 rows and 0 columns (presolve time = 30s) ...
Presolve removed 0 rows and 0 columns (presolve time = 54s) ...
Presolve removed 0 rows and 0 columns (presolve time = 100s) ...
Presolve removed 0 rows and 0 columns (presolve time = 199s) ...
Presolve removed 0 rows and 0 columns (presolve time = 211s) ...
Presolve time: 234.50s
Presolved: 13749 rows, 81909 columns, 937145577 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 9.451e+07
 Factor NZ  : 9.452e+07 (roughly 800 MBytes of memory)
 Factor Ops : 8.664e+11 (roughly 20 seconds per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.59379618e+04  0.00000000e+00  0.00e+00 0.00e+00  1.16e+00   478s
   1   2.08521790e+04  3.45827881e+03  0.00e+00 3.26e-02  2.39e-01   602s
   2   1.39104535e+04  6.57047260e+03  0.00e+00 9.46e-03  9.00e-02   733s
   3   1.15095596e+04  7.38177850e+03  0.00e+00 6.13e-03  4.72e-02   863s
   4   1.02498034e+04  7.69126647e+03  0.00e+00 3.89e-03  2.84e-02   993s
   5   9.01952307e+03  7.83553144e+03  0.00e+00 2.25e-03  1.29e-02  1129s
   6   8.53230484e+03  7.95787125e+03  0.00e+00 1.23e-03  6.17e-03  1267s
   7   8.33350215e+03  8.02220931e+03  0.00e+00 7.59e-04  3.33e-03  1405s
   8   8.24959132e+03  8.06275053e+03  0.00e+00 5.07e-04  1.99e-03  1539s
   9   8.20688451e+03  8.08780916e+03  0.00e+00 3.53e-04  1.27e-03  1671s
  10   8.18101103e+03  8.10219732e+03  0.00e+00 2.64e-04  8.40e-04  1799s
  11   8.17026908e+03  8.11225809e+03  0.00e+00 1.96e-04  6.18e-04  1925s
  12   8.16053895e+03  8.12167100e+03  0.00e+00 1.36e-04  4.14e-04  2052s
  13   8.15149134e+03  8.13138149e+03  0.00e+00 7.44e-05  2.14e-04  2182s
  14   8.14519137e+03  8.13666881e+03  0.00e+00 3.79e-05  9.10e-05  2311s
  15   8.14327760e+03  8.13979233e+03  0.00e+00 1.54e-05  3.72e-05  2444s
  16   8.14247587e+03  8.14107254e+03  0.00e+00 6.56e-06  1.50e-05  2573s
  17   8.14220177e+03  8.14157745e+03  0.00e+00 3.20e-06  6.69e-06  2705s
  18   8.14213755e+03  8.14183337e+03  0.00e+00 1.50e-06  3.26e-06  2832s
  19   8.14210280e+03  8.14196161e+03  0.00e+00 6.72e-07  1.51e-06  2957s
  20   8.14207952e+03  8.14203240e+03  6.50e-08 2.13e-07  5.03e-07  3085s
  21   8.14207076e+03  8.14205854e+03  3.28e-07 4.57e-08  1.30e-07  3223s
  22   8.14206674e+03  8.14206497e+03  4.54e-08 5.42e-09  1.88e-08  3381s
  23   8.14206674e+03  8.14206507e+03  1.02e-07 4.84e-09  1.77e-08  3529s
  24   8.14206674e+03  8.14206533e+03  1.07e-07 3.46e-09  1.48e-08  3674s
  25   8.14206672e+03  8.14206567e+03  1.19e-07 1.32e-09  1.10e-08  3811s
  26   8.14206669e+03  8.14206585e+03  1.63e-07 2.26e-10  8.78e-09  3947s
  27   8.14206669e+03  8.14206587e+03  3.28e-07 1.05e-10  8.52e-09  4092s
  28   8.14206667e+03  8.14206588e+03  6.18e-07 7.65e-11  8.39e-09  4241s
  29   8.14206667e+03  8.14206589e+03  8.69e-07 2.80e-11  8.18e-09  4384s
  30   8.14206670e+03  8.14206589e+03  1.55e-06 2.30e-11  8.10e-09  4521s
  31   8.14206661e+03  8.14206589e+03  1.95e-06 3.35e-12  7.68e-09  4659s
  32   8.14206656e+03  8.14206589e+03  3.64e-06 2.84e-12  7.08e-09  4805s
  33   8.14206644e+03  8.14206589e+03  4.41e-06 1.22e-12  5.55e-09  4958s
  34   8.14206641e+03  8.14206589e+03  7.39e-06 1.50e-12  4.69e-09  5100s
  35   8.14206658e+03  8.14206589e+03  1.10e-05 1.12e-12  4.68e-09  5232s
  36   8.14206642e+03  8.14206584e+03  1.43e-05 1.33e-12  4.52e-09  5378s
  37   8.14206620e+03  8.14206586e+03  1.62e-05 1.01e-12  3.49e-09  5529s
  38   8.14206571e+03  8.14206587e+03  3.11e-05 1.28e-12  1.15e-09  5677s
  39   8.14206605e+03  8.14206588e+03  2.76e-05 1.42e-12  5.72e-10  5812s
  40   8.14206587e+03  8.14206589e+03  1.72e-05 9.41e-13  1.97e-10  5960s
  41   8.14206595e+03  8.14206589e+03  1.91e-05 1.02e-12  1.74e-10  6126s
  42   8.14206547e+03  8.14206589e+03  1.99e-05 1.22e-12  5.57e-11  6267s
  43   8.14206604e+03  8.14206589e+03  1.77e-05 1.36e-12  1.49e-11  6407s
  44   8.14206607e+03  8.14206589e+03  2.59e-05 1.22e-12  5.31e-12  6563s
  45   8.14206613e+03  8.14206589e+03  2.10e-05 1.15e-12  4.31e-12  6707s
  46   8.14206591e+03  8.14206589e+03  1.31e-05 1.23e-12  2.02e-12  6858s
  47   8.14206576e+03  8.14206589e+03  1.30e-05 1.24e-12  1.40e-12  7000s
  48   8.14206583e+03  8.14206589e+03  1.43e-05 1.21e-12  1.05e-12  7195s
  49   8.14206588e+03  8.14206589e+03  1.97e-05 1.04e-12  6.91e-13  7379s
  50   8.14206585e+03  8.14206589e+03  2.98e-05 1.04e-12  5.28e-13  7540s
  51   8.14206575e+03  8.14206589e+03  2.94e-05 1.06e-12  5.12e-13  7678s

Barrier performed 51 iterations in 7677.66 seconds
Sub-optimal termination - objective 8.14206674e+03

Optimization finished!
/user/kstlaurent/anaconda3/envs/coron_gur/lib/python3.6/site-packages/asdf/extension.py:211: AsdfDeprecationWarning: The module asdf.asdftypes has been deprecated and will be removed in 3.0. Use asdf.types instead. (from astropy.io.misc.asdf.extension.AstropyExtension)
  AsdfDeprecationWarning)
