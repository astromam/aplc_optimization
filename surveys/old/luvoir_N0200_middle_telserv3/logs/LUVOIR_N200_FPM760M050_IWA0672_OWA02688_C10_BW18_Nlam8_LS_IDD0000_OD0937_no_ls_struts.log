Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 7.6},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 6.72,
           'num_wavelengths': 8,
           'owa': 26.88,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0000_OD0937_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_middle_telserv3'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 34080 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 68160 rows, 13749 columns and 937131814 nonzeros
Coefficient statistics:
  Matrix range     [1e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 31s) ...
Presolve removed 0 rows and 0 columns (presolve time = 54s) ...
Presolve removed 0 rows and 0 columns (presolve time = 95s) ...
Presolve removed 0 rows and 0 columns (presolve time = 185s) ...
Presolve removed 0 rows and 0 columns (presolve time = 196s) ...
Presolve time: 217.30s
Presolved: 13749 rows, 81909 columns, 937145563 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 9.451e+07
 Factor NZ  : 9.452e+07 (roughly 800 MBytes of memory)
 Factor Ops : 8.664e+11 (roughly 23 seconds per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.87558584e+04  0.00000000e+00  0.00e+00 0.00e+00  1.22e+00   465s
   1   2.23423529e+04  3.09668231e+03  0.00e+00 6.55e-02  3.16e-01   591s
   2   1.55061414e+04  6.53222558e+03  0.00e+00 2.17e-02  1.18e-01   722s
   3   1.19459117e+04  7.52277878e+03  0.00e+00 7.52e-03  5.11e-02   857s
   4   1.03986287e+04  7.79919305e+03  0.00e+00 3.39e-03  2.87e-02   994s
   5   9.18192118e+03  7.93263614e+03  0.00e+00 2.19e-03  1.35e-02  1131s
   6   8.50270194e+03  8.03659128e+03  0.00e+00 1.05e-03  4.97e-03  1273s
   7   8.31837569e+03  8.10123585e+03  0.00e+00 4.83e-04  2.30e-03  1410s
   8   8.25802334e+03  8.12724466e+03  0.00e+00 2.93e-04  1.38e-03  1547s
   9   8.20392519e+03  8.14034553e+03  0.00e+00 2.06e-04  6.72e-04  1680s
  10   8.19026802e+03  8.15279728e+03  0.00e+00 1.23e-04  3.96e-04  1809s
  11   8.18354724e+03  8.15902356e+03  0.00e+00 8.04e-05  2.59e-04  1935s
  12   8.17802344e+03  8.16297749e+03  0.00e+00 5.41e-05  1.59e-04  2064s
  13   8.17411167e+03  8.16724777e+03  0.00e+00 2.55e-05  7.26e-05  2199s
  14   8.17217366e+03  8.16971118e+03  0.00e+00 8.08e-06  2.60e-05  2334s
  15   8.17121824e+03  8.17056530e+03  0.00e+00 2.32e-06  6.90e-06  2467s
  16   8.17101165e+03  8.17081423e+03  0.00e+00 7.56e-07  2.09e-06  2601s
  17   8.17095266e+03  8.17090794e+03  2.04e-07 1.85e-07  4.74e-07  2735s
  18   8.17094369e+03  8.17092752e+03  3.52e-07 7.17e-08  1.71e-07  2867s
  19   8.17094178e+03  8.17093673e+03  5.68e-07 1.86e-08  5.33e-08  3000s
  20   8.17094042e+03  8.17093940e+03  1.21e-06 3.85e-09  1.09e-08  3136s
  21   8.17094036e+03  8.17093983e+03  1.75e-06 1.54e-09  5.57e-09  3285s
  22   8.17094035e+03  8.17093983e+03  2.43e-06 1.54e-09  5.56e-09  3436s
  23   8.17094034e+03  8.17093988e+03  4.57e-06 1.26e-09  4.86e-09  3579s
  24   8.17094030e+03  8.17093993e+03  7.78e-06 9.83e-10  3.73e-09  3729s
  25   8.17094030e+03  8.17093998e+03  7.72e-06 7.36e-10  2.98e-09  3879s
  26   8.17094003e+03  8.17094003e+03  6.53e-06 4.26e-10  1.78e-09  4026s
  27   8.17094006e+03  8.17094006e+03  7.11e-06 3.09e-10  1.40e-09  4203s
  28   8.17094008e+03  8.17094010e+03  1.29e-05 8.17e-11  9.59e-10  4370s
  29   8.17094027e+03  8.17094010e+03  2.23e-05 6.56e-11  5.48e-10  4526s
  30   8.17094024e+03  8.17094011e+03  2.30e-05 1.89e-11  2.94e-10  4672s
  31   8.17094044e+03  8.17094011e+03  2.14e-05 8.71e-12  1.59e-10  4809s
  32   8.17094029e+03  8.17094011e+03  2.39e-05 1.08e-12  2.37e-11  4952s
  33   8.17094042e+03  8.17094011e+03  2.42e-05 1.08e-12  2.37e-11  5088s
  34   8.17094042e+03  8.17094011e+03  2.44e-05 1.29e-12  2.32e-11  5226s
  35   8.17094012e+03  8.17094011e+03  1.29e-05 1.75e-12  7.59e-12  5390s
  36   8.17094022e+03  8.17094011e+03  1.24e-05 1.54e-12  7.11e-12  5528s
  37   8.17094035e+03  8.17094011e+03  1.64e-05 1.33e-12  6.36e-12  5682s
  38   8.17094017e+03  8.17094011e+03  1.79e-05 1.13e-12  3.79e-12  5839s
  39   8.17094039e+03  8.17094011e+03  2.07e-05 1.33e-12  3.50e-12  6009s
  40   8.17094041e+03  8.17094011e+03  2.03e-05 1.36e-12  3.42e-12  6156s
  41   8.17094037e+03  8.17094011e+03  1.74e-05 1.41e-12  3.05e-12  6314s
  42   8.17094052e+03  8.17094011e+03  1.70e-05 1.19e-12  1.72e-12  6472s
  43   8.17094049e+03  8.17094011e+03  1.71e-05 1.32e-12  1.66e-12  6612s
  44   8.17094034e+03  8.17094011e+03  2.98e-05 1.06e-12  1.25e-12  6746s
  45   8.17094040e+03  8.17094011e+03  3.24e-05 9.60e-13  1.25e-12  6908s
  46   8.17094018e+03  8.17094011e+03  3.21e-05 9.03e-13  7.75e-13  7057s
  47   8.17094015e+03  8.17094011e+03  3.62e-05 1.03e-12  7.29e-13  7217s
  48   8.17094004e+03  8.17094011e+03  4.51e-05 1.11e-12  6.15e-13  7377s
  49   8.17094011e+03  8.17094011e+03  4.58e-05 1.13e-12  6.07e-13  7526s
  50   8.17094013e+03  8.17094011e+03  4.40e-05 9.99e-13  5.96e-13  7670s
  51   8.17094028e+03  8.17094011e+03  4.89e-05 9.98e-13  5.90e-13  7808s

Barrier performed 51 iterations in 7807.58 seconds
Sub-optimal termination - objective 8.17094178e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 68160 rows, 13749 columns and 937131814 nonzeros
Coefficient statistics:
  Matrix range     [1e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [8e-06, 8e-06]
Presolve removed 0 rows and 0 columns (presolve time = 32s) ...
Presolve removed 0 rows and 0 columns (presolve time = 56s) ...
Presolve removed 0 rows and 0 columns (presolve time = 97s) ...
Presolve removed 0 rows and 0 columns (presolve time = 191s) ...
Presolve removed 0 rows and 0 columns (presolve time = 202s) ...
Presolve time: 231.26s
Presolved: 13749 rows, 81909 columns, 937145563 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 9.451e+07
 Factor NZ  : 9.452e+07 (roughly 800 MBytes of memory)
 Factor Ops : 8.664e+11 (roughly 20 seconds per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.72978444e+04  0.00000000e+00  0.00e+00 0.00e+00  1.19e+00   481s
   1   2.12274481e+04  3.00273119e+03  0.00e+00 7.00e-02  3.17e-01   609s
   2   1.48684544e+04  6.49687604e+03  0.00e+00 2.15e-02  1.13e-01   735s
   3   1.13545817e+04  7.39508939e+03  0.00e+00 9.33e-03  4.75e-02   865s
   4   9.48441049e+03  7.74711359e+03  0.00e+00 4.33e-03  1.96e-02  1000s
   5   8.79561730e+03  7.92387710e+03  0.00e+00 2.19e-03  9.51e-03  1136s
   6   8.65406418e+03  7.97721033e+03  0.00e+00 1.56e-03  7.32e-03  1266s
   7   8.46497979e+03  8.02634109e+03  0.00e+00 1.07e-03  4.71e-03  1399s
   8   8.24580812e+03  8.07142010e+03  0.00e+00 6.44e-04  1.86e-03  1543s
   9   8.19464492e+03  8.11007773e+03  0.00e+00 2.65e-04  8.97e-04  1682s
  10   8.16081990e+03  8.12629315e+03  0.00e+00 1.33e-04  3.66e-04  1818s
  11   8.15168691e+03  8.13691579e+03  0.00e+00 5.33e-05  1.56e-04  1955s
  12   8.14610976e+03  8.14089086e+03  0.00e+00 2.33e-05  5.54e-05  2086s
  13   8.14501148e+03  8.14282198e+03  0.00e+00 9.44e-06  2.32e-05  2215s
  14   8.14462824e+03  8.14336820e+03  0.00e+00 5.57e-06  1.34e-05  2343s
  15   8.14440272e+03  8.14368900e+03  0.00e+00 3.37e-06  7.59e-06  2468s
  16   8.14430642e+03  8.14393118e+03  0.00e+00 1.69e-06  3.99e-06  2593s
  17   8.14425956e+03  8.14404451e+03  0.00e+00 9.10e-07  2.28e-06  2715s
  18   8.14421633e+03  8.14411064e+03  0.00e+00 4.57e-07  1.12e-06  2841s
  19   8.14419584e+03  8.14415002e+03  6.15e-08 1.87e-07  4.86e-07  2963s
  20   8.14418423e+03  8.14417060e+03  5.53e-07 5.00e-08  1.44e-07  3092s
  21   8.14417932e+03  8.14417687e+03  7.22e-07 9.27e-09  2.60e-08  3222s
  22   8.14417843e+03  8.14417825e+03  8.76e-08 6.97e-10  1.85e-09  3400s
  23   8.14417843e+03  8.14417837e+03  1.11e-07 4.46e-11  6.26e-10  3557s

Barrier solved model in 23 iterations and 3556.93 seconds
Optimal objective 8.14417843e+03

Optimization finished!
/user/kstlaurent/anaconda3/envs/coron_gur/lib/python3.6/site-packages/asdf/extension.py:211: AsdfDeprecationWarning: The module asdf.asdftypes has been deprecated and will be removed in 3.0. Use asdf.types instead. (from astropy.io.misc.asdf.extension.AstropyExtension)
  AsdfDeprecationWarning)
