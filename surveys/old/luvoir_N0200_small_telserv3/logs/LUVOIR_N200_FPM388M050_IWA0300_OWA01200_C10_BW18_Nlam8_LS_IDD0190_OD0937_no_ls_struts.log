Optimizer called with the following parameters:
{'focal_plane_mask': {'field_stop_radius': -1.0,
                      'grayscale': True,
                      'num_pix': 50,
                      'radius': 3.88},
 'image': {'bandwidth': 0.18,
           'contrast': 10,
           'iwa': 3.0,
           'num_wavelengths': 8,
           'owa': 12.0,
           'resolution': 2},
 'lyot_stop': {'alignment_tolerance': 0,
               'filename': 'LUVOIR/LS_LUVOIR_ID0190_OD0937_no_struts_gy_ovsamp4_N0200.fits',
               'num_lyot_stops': 1},
 'method': {'edge_width_for_prior': 2,
            'ending_scale': 1,
            'force_no_hermitian_symmetry': False,
            'force_no_x_mirror_symmetry': False,
            'force_no_y_mirror_symmetry': False,
            'initial_throughput_estimate': 1,
            'maximize_planet_throughput': True,
            'num_throughput_iterations': 2,
            'starting_scale': 1},
 'pupil': {'N': 200,
           'filename': 'LUVOIR/TelAp_LUVOIR_gap_pad04_bw_ovsamp04_N0200.fits'},
 'solver': {'crossover': 0,
            'method': 2,
            'num_threads': 0}}

File organization:
{'analysis_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_telserv3/analysis',
 'drivers_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_telserv3/drivers',
 'input_files_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/masks',
 'log_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_telserv3/logs',
 'solution_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_telserv3/solutions',
 'survey_dir': '/user/kstlaurent/git/progressive_refinement_coronagraphy/surveys/luvoir_N0200_small_telserv3'}

Telescope pupil:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Lyot stop #0:
   Mirror symmetry in x: yes
Lyot stop #0:
   Mirror symmetry in y: yes

Complete APLC:
   Mirror symmetry in x: yes
   Mirror symmetry in y: no

Starting optimization at scale 1 with 13749 variables and 6768 constraints.
Creating model...
Academic license - for non-commercial use only
Parameter Threads unchanged
   Value: 0  Min: 0  Max: 1024  Default: 0
Changed value of parameter Crossover to 0
   Prev: -1  Min: -1  Max: 5  Default: -1
Changed value of parameter Method to 2
   Prev: -1  Min: -1  Max: 5  Default: -1
Calculating and adding constraints...
Wavelength 1/8; Variable 1000/13749
Wavelength 1/8; Variable 2000/13749
Wavelength 1/8; Variable 3000/13749
Wavelength 1/8; Variable 4000/13749
Wavelength 1/8; Variable 5000/13749
Wavelength 1/8; Variable 6000/13749
Wavelength 1/8; Variable 7000/13749
Wavelength 1/8; Variable 8000/13749
Wavelength 1/8; Variable 9000/13749
Wavelength 1/8; Variable 10000/13749
Wavelength 1/8; Variable 11000/13749
Wavelength 1/8; Variable 12000/13749
Wavelength 1/8; Variable 13000/13749
Wavelength 2/8; Variable 1000/13749
Wavelength 2/8; Variable 2000/13749
Wavelength 2/8; Variable 3000/13749
Wavelength 2/8; Variable 4000/13749
Wavelength 2/8; Variable 5000/13749
Wavelength 2/8; Variable 6000/13749
Wavelength 2/8; Variable 7000/13749
Wavelength 2/8; Variable 8000/13749
Wavelength 2/8; Variable 9000/13749
Wavelength 2/8; Variable 10000/13749
Wavelength 2/8; Variable 11000/13749
Wavelength 2/8; Variable 12000/13749
Wavelength 2/8; Variable 13000/13749
Wavelength 3/8; Variable 1000/13749
Wavelength 3/8; Variable 2000/13749
Wavelength 3/8; Variable 3000/13749
Wavelength 3/8; Variable 4000/13749
Wavelength 3/8; Variable 5000/13749
Wavelength 3/8; Variable 6000/13749
Wavelength 3/8; Variable 7000/13749
Wavelength 3/8; Variable 8000/13749
Wavelength 3/8; Variable 9000/13749
Wavelength 3/8; Variable 10000/13749
Wavelength 3/8; Variable 11000/13749
Wavelength 3/8; Variable 12000/13749
Wavelength 3/8; Variable 13000/13749
Wavelength 4/8; Variable 1000/13749
Wavelength 4/8; Variable 2000/13749
Wavelength 4/8; Variable 3000/13749
Wavelength 4/8; Variable 4000/13749
Wavelength 4/8; Variable 5000/13749
Wavelength 4/8; Variable 6000/13749
Wavelength 4/8; Variable 7000/13749
Wavelength 4/8; Variable 8000/13749
Wavelength 4/8; Variable 9000/13749
Wavelength 4/8; Variable 10000/13749
Wavelength 4/8; Variable 11000/13749
Wavelength 4/8; Variable 12000/13749
Wavelength 4/8; Variable 13000/13749
Wavelength 5/8; Variable 1000/13749
Wavelength 5/8; Variable 2000/13749
Wavelength 5/8; Variable 3000/13749
Wavelength 5/8; Variable 4000/13749
Wavelength 5/8; Variable 5000/13749
Wavelength 5/8; Variable 6000/13749
Wavelength 5/8; Variable 7000/13749
Wavelength 5/8; Variable 8000/13749
Wavelength 5/8; Variable 9000/13749
Wavelength 5/8; Variable 10000/13749
Wavelength 5/8; Variable 11000/13749
Wavelength 5/8; Variable 12000/13749
Wavelength 5/8; Variable 13000/13749
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Wavelength 6/8; Variable 1000/13749
Wavelength 6/8; Variable 2000/13749
Wavelength 6/8; Variable 3000/13749
Wavelength 6/8; Variable 4000/13749
Wavelength 6/8; Variable 5000/13749
Wavelength 6/8; Variable 6000/13749
Wavelength 6/8; Variable 7000/13749
Wavelength 6/8; Variable 8000/13749
Wavelength 6/8; Variable 9000/13749
Wavelength 6/8; Variable 10000/13749
Wavelength 6/8; Variable 11000/13749
Wavelength 6/8; Variable 12000/13749
Wavelength 6/8; Variable 13000/13749
Wavelength 7/8; Variable 1000/13749
Wavelength 7/8; Variable 2000/13749
Wavelength 7/8; Variable 3000/13749
Wavelength 7/8; Variable 4000/13749
Wavelength 7/8; Variable 5000/13749
Wavelength 7/8; Variable 6000/13749
Wavelength 7/8; Variable 7000/13749
Wavelength 7/8; Variable 8000/13749
Wavelength 7/8; Variable 9000/13749
Wavelength 7/8; Variable 10000/13749
Wavelength 7/8; Variable 11000/13749
Wavelength 7/8; Variable 12000/13749
Wavelength 7/8; Variable 13000/13749
Wavelength 8/8; Variable 1000/13749
Wavelength 8/8; Variable 2000/13749
Wavelength 8/8; Variable 3000/13749
Wavelength 8/8; Variable 4000/13749
Wavelength 8/8; Variable 5000/13749
Wavelength 8/8; Variable 6000/13749
Wavelength 8/8; Variable 7000/13749
Wavelength 8/8; Variable 8000/13749
Wavelength 8/8; Variable 9000/13749
Wavelength 8/8; Variable 10000/13749
Wavelength 8/8; Variable 11000/13749
Wavelength 8/8; Variable 12000/13749
Wavelength 8/8; Variable 13000/13749
Start optimization...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [4e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-05, 1e-05]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 37s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 41s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 40.72s
Presolved: 6768 rows, 20517 columns, 93059988 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53913474e+06  3.07689342e+04  2.88e+01 5.28e-11  9.15e+02    56s
   1   1.29638749e+04  3.07122153e+04  4.56e-02 4.07e-10  2.05e+00    61s
   2   8.30167892e+03  1.54794052e+04  1.38e-02 1.77e-09  5.10e-01    66s
   3   7.51845086e+03  9.97772754e+03  4.85e-03 3.11e-09  1.48e-01    71s
   4   7.13894603e+03  8.17800508e+03  2.07e-03 6.16e-09  5.38e-02    76s
   5   7.01293834e+03  7.53827624e+03  9.83e-04 7.55e-09  2.40e-02    82s
   6   6.98481926e+03  7.29771306e+03  5.96e-04 6.57e-09  1.38e-02    87s
   7   6.97827812e+03  7.18246604e+03  4.35e-04 1.09e-08  9.24e-03    92s
   8   6.97627501e+03  7.12516012e+03  3.49e-04 8.34e-09  6.95e-03    97s
   9   6.97360747e+03  7.10232357e+03  2.80e-04 7.21e-09  5.78e-03   102s
  10   6.97220744e+03  7.07365246e+03  2.36e-04 7.76e-09  4.66e-03   107s
  11   6.97128928e+03  7.05183949e+03  2.02e-04 8.24e-09  3.81e-03   112s
  12   6.97104806e+03  7.03388676e+03  1.48e-04 9.44e-09  2.87e-03   116s
  13   6.97071603e+03  7.01246437e+03  1.10e-04 8.27e-09  2.00e-03   122s
  14   6.97092647e+03  6.99726942e+03  8.36e-05 7.58e-09  1.39e-03   127s
  15   6.97126772e+03  6.99017443e+03  6.57e-05 7.95e-09  1.05e-03   132s
  16   6.97118021e+03  6.98513533e+03  5.19e-05 8.99e-09  8.01e-04   137s
  17   6.97103499e+03  6.98198221e+03  4.06e-05 9.33e-09  6.27e-04   142s
  18   6.97131431e+03  6.97932464e+03  3.17e-05 9.42e-09  4.76e-04   147s
  19   6.97142162e+03  6.97601172e+03  2.13e-05 8.64e-09  3.01e-04   152s
  20   6.97115731e+03  6.97288189e+03  1.25e-05 1.08e-08  1.53e-04   158s
  21   6.97109004e+03  6.97215637e+03  6.87e-06 1.26e-08  8.68e-05   163s
  22   6.97097447e+03  6.97157937e+03  3.71e-06 9.33e-09  4.76e-05   168s
  23   6.97095376e+03  6.97135417e+03  2.34e-06 9.56e-09  3.05e-05   173s
  24   6.97094563e+03  6.97120321e+03  1.80e-06 8.65e-09  2.22e-05   177s
  25   6.97093541e+03  6.97104297e+03  9.07e-07 9.92e-09  1.07e-05   182s
  26   6.97093113e+03  6.97098137e+03  2.45e-07 9.04e-09  3.40e-06   187s
  27   6.97093212e+03  6.97094691e+03  4.43e-08 1.00e-08  7.53e-07   192s
  28   6.97093365e+03  6.97093629e+03  5.52e-09 1.11e-08  1.13e-07   197s
  29   6.97093417e+03  6.97093494e+03  1.11e-09 1.35e-08  2.88e-08   203s
  30   6.97093426e+03  6.97093445e+03  3.83e-10 1.24e-08  8.16e-09   207s
  31   6.97093430e+03  6.97093434e+03  2.78e-11 1.39e-08  1.14e-09   212s

Barrier solved model in 31 iterations and 212.50 seconds
Optimal objective 6.97093430e+03

Optimization finished!
Restarting optimization for throughput iteration 1...
Optimize a model with 13536 rows, 13749 columns and 186106460 nonzeros
Coefficient statistics:
  Matrix range     [4e-13, 2e-04]
  Objective range  [5e-02, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [7e-06, 7e-06]
Presolve removed 0 rows and 0 columns (presolve time = 6s) ...
Presolve removed 0 rows and 0 columns (presolve time = 17s) ...
Presolve removed 0 rows and 0 columns (presolve time = 38s) ...
Presolve removed 6768 rows and 0 columns (presolve time = 41s) ...
Presolve removed 6768 rows and 0 columns
Presolve time: 41.61s
Presolved: 6768 rows, 20517 columns, 93059988 nonzeros
Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 2.290e+07
 Factor NZ  : 2.291e+07 (roughly 200 MBytes of memory)
 Factor Ops : 1.034e+11 (roughly 1 second per iteration)
 Threads    : 24

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.53913474e+06  3.03942159e+04  2.88e+01 5.28e-11  9.15e+02    58s
   1   1.29545127e+04  3.03376182e+04  4.55e-02 3.61e-10  2.04e+00    63s
   2   8.26779621e+03  1.51483167e+04  1.36e-02 1.64e-09  5.04e-01    68s
   3   7.37969915e+03  9.67732072e+03  4.36e-03 8.27e-09  1.38e-01    73s
   4   7.16873448e+03  8.14221036e+03  2.52e-03 4.97e-09  6.24e-02    79s
   5   7.02762086e+03  7.56781016e+03  1.42e-03 7.04e-09  3.22e-02    85s
   6   6.99341797e+03  7.42297073e+03  1.01e-03 7.54e-09  2.33e-02    91s
   7   6.96035163e+03  7.24184263e+03  7.20e-04 8.58e-09  1.53e-02    96s
   8   6.95103597e+03  7.16264495e+03  6.10e-04 9.33e-09  1.20e-02   101s
   9   6.93405428e+03  7.11946080e+03  4.64e-04 9.94e-09  9.63e-03   106s
  10   6.93093163e+03  7.09523737e+03  4.37e-04 7.38e-09  8.75e-03   111s
  11   6.92331419e+03  7.04819942e+03  3.67e-04 1.03e-07  6.93e-03   116s
  12   6.91830060e+03  7.02011992e+03  3.21e-04 1.83e-07  5.83e-03   121s
  13   6.91118106e+03  6.98307299e+03  2.50e-04 8.27e-09  4.30e-03   127s
  14   6.90649460e+03  6.95568571e+03  1.92e-04 9.08e-09  3.12e-03   132s
  15   6.90335153e+03  6.93524242e+03  1.52e-04 2.86e-08  2.28e-03   138s
  16   6.90207889e+03  6.92587409e+03  1.29e-04 8.25e-09  1.84e-03   143s
  17   6.90053332e+03  6.91981861e+03  1.12e-04 1.02e-08  1.57e-03   147s
  18   6.89814762e+03  6.91297998e+03  8.70e-05 8.21e-09  1.21e-03   152s
  19   6.89611619e+03  6.90796125e+03  6.47e-05 1.06e-08  9.17e-04   157s
  20   6.89507897e+03  6.90197015e+03  5.01e-05 9.50e-09  6.55e-04   163s
  21   6.89410742e+03  6.89837092e+03  3.82e-05 1.01e-08  4.75e-04   168s
  22   6.89350272e+03  6.89469373e+03  3.18e-05 9.43e-08  3.37e-04   173s
  23   6.89281078e+03  6.89327565e+03  2.36e-05 1.37e-08  2.40e-04   178s
  24   6.89244104e+03  6.89276374e+03  1.93e-05 9.13e-09  1.95e-04   183s
  25   6.89197986e+03  6.89200132e+03  1.32e-05 1.08e-08  1.29e-04   189s
  26   6.89159874e+03  6.89157129e+03  9.26e-06 1.96e-08  8.94e-05   194s
  27   6.89139075e+03  6.89113965e+03  6.48e-06 6.54e-08  5.69e-05   200s
  28   6.89102640e+03  6.89088839e+03  3.23e-06 5.80e-08  2.80e-05   205s
  29   6.89092010e+03  6.89080258e+03  1.76e-06 1.10e-07  1.42e-05   211s
  30   6.89080142e+03  6.89075195e+03  8.27e-07 1.06e-08  6.85e-06   216s
  31   6.89074798e+03  6.89073012e+03  3.98e-07 1.19e-08  3.44e-06   220s
  32   6.89073990e+03  6.89072059e+03  3.31e-07 1.59e-07  2.76e-06   225s
  33   6.89071774e+03  6.89071300e+03  1.45e-07 5.68e-08  1.30e-06   231s
  34   6.89070576e+03  6.89070657e+03  3.98e-08 1.25e-08  4.07e-07   236s
  35   6.89070273e+03  6.89070210e+03  1.34e-08 1.53e-08  1.15e-07   242s
  36   6.89070161e+03  6.89070159e+03  2.80e-09 1.49e-08  2.67e-08   248s
  37   6.89070148e+03  6.89070146e+03  1.20e-09 6.31e-08  1.12e-08   253s
  38   6.89070142e+03  6.89070140e+03  2.91e-10 2.28e-08  2.61e-09   259s

Barrier solved model in 38 iterations and 259.30 seconds
Optimal objective 6.89070142e+03

Optimization finished!
/user/kstlaurent/anaconda3/envs/coron_gur/lib/python3.6/site-packages/asdf/extension.py:211: AsdfDeprecationWarning: The module asdf.asdftypes has been deprecated and will be removed in 3.0. Use asdf.types instead. (from astropy.io.misc.asdf.extension.AstropyExtension)
  AsdfDeprecationWarning)
